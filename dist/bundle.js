/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={426:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(81),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,"/* src/style.css */\nbody {\n    font-family: Arial, sans-serif;\n  }\n  .container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    height: 100vh;\n  }\n  .button {\n    padding: 10px 20px;\n    margin-bottom: 10px;\n    font-size: 18px;\n  }\n  .form-group {\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 10px;\n  }\n  .form-group label {\n    font-weight: bold;\n  }\n  .form-group input,\n  .form-group select {\n    margin-top: 5px;\n    padding: 5px;\n    font-size: 16px;\n  }\n  .button {\n    padding: 10px 20px;\n    margin-top: 20px;\n    font-size: 18px;\n  }",""]);const a=o},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);r&&o[u[0]]||(void 0!==s&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=s),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),e.push(u))}},e}},81:t=>{"use strict";t.exports=function(t){return t[1]}},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var h=t[a],l=r.base?h[0]+r.base:h[0],u=s[l]||0,c="".concat(l," ").concat(u);s[l]=u+1;var d=n(c),f={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var p=i(f,r);r.byIndex=a,e.splice(a,0,{identifier:c,updater:p,references:1})}o.push(c)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=r(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var h=r(t,i),l=0;l<s.length;l++){var u=n(s[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}s=h}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},421:()=>{var t;!function(){function e(t){this.mode=r.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var e=0,n=this.data.length;e<n;e++){var i=[],s=this.data.charCodeAt(e);s>65536?(i[0]=240|(1835008&s)>>>18,i[1]=128|(258048&s)>>>12,i[2]=128|(4032&s)>>>6,i[3]=128|63&s):s>2048?(i[0]=224|(61440&s)>>>12,i[1]=128|(4032&s)>>>6,i[2]=128|63&s):s>128?(i[0]=192|(1984&s)>>>6,i[1]=128|63&s):i[0]=s,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function n(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(t){return this.parsedData.length},write:function(t){for(var e=0,n=this.parsedData.length;e<n;e++)t.put(this.parsedData[e],8)}},n.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=n.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var r=-1;r<=7;r++)e+r<=-1||this.moduleCount<=e+r||(this.modules[t+n][e+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},getBestMaskPattern:function(){for(var t=0,e=0,n=0;n<8;n++){this.makeImpl(!0,n);var r=s.getLostPoint(this);(0==n||t>r)&&(t=r,e=n)}return e},createMovieClip:function(t,e,n){var r=t.createEmptyMovieClip(e,n);this.make();for(var i=0;i<this.modules.length;i++)for(var s=1*i,o=0;o<this.modules[i].length;o++){var a=1*o;this.modules[i][o]&&(r.beginFill(0,100),r.moveTo(a,s),r.lineTo(a+1,s),r.lineTo(a+1,s+1),r.lineTo(a,s+1),r.endFill())}return r},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=s.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var r=t[e],i=t[n];if(null==this.modules[r][i])for(var o=-2;o<=2;o++)for(var a=-2;a<=2;a++)this.modules[r+o][i+a]=-2==o||2==o||-2==a||2==a||0==o&&0==a}},setupTypeNumber:function(t){for(var e=s.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var r=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(n=0;n<18;n++)r=!t&&1==(e>>n&1),this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r},setupTypeInfo:function(t,e){for(var n=this.errorCorrectLevel<<3|e,r=s.getBCHTypeInfo(n),i=0;i<15;i++){var o=!t&&1==(r>>i&1);i<6?this.modules[i][8]=o:i<8?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(i=0;i<15;i++)o=!t&&1==(r>>i&1),i<8?this.modules[8][this.moduleCount-i-1]=o:i<9?this.modules[8][15-i-1+1]=o:this.modules[8][15-i-1]=o;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var n=-1,r=this.moduleCount-1,i=7,o=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var h=0;h<2;h++)if(null==this.modules[r][a-h]){var l=!1;o<t.length&&(l=1==(t[o]>>>i&1)),s.getMask(e,r,a-h)&&(l=!l),this.modules[r][a-h]=l,-1==--i&&(o++,i=7)}if((r+=n)<0||this.moduleCount<=r){r-=n,n=-n;break}}}},n.PAD0=236,n.PAD1=17,n.createData=function(t,e,r){for(var i=l.getRSBlocks(t,e),o=new u,a=0;a<r.length;a++){var h=r[a];o.put(h.mode,4),o.put(h.getLength(),s.getLengthInBits(h.mode,t)),h.write(o)}var c=0;for(a=0;a<i.length;a++)c+=i[a].dataCount;if(o.getLengthInBits()>8*c)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*c+")");for(o.getLengthInBits()+4<=8*c&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*c||(o.put(n.PAD0,8),o.getLengthInBits()>=8*c));)o.put(n.PAD1,8);return n.createBytes(o,i)},n.createBytes=function(t,e){for(var n=0,r=0,i=0,o=new Array(e.length),a=new Array(e.length),l=0;l<e.length;l++){var u=e[l].dataCount,c=e[l].totalCount-u;r=Math.max(r,u),i=Math.max(i,c),o[l]=new Array(u);for(var d=0;d<o[l].length;d++)o[l][d]=255&t.buffer[d+n];n+=u;var f=s.getErrorCorrectPolynomial(c),p=new h(o[l],f.getLength()-1).mod(f);for(a[l]=new Array(f.getLength()-1),d=0;d<a[l].length;d++){var g=d+p.getLength()-a[l].length;a[l][d]=g>=0?p.get(g):0}}var m=0;for(d=0;d<e.length;d++)m+=e[d].totalCount;var y=new Array(m),v=0;for(d=0;d<r;d++)for(l=0;l<e.length;l++)d<o[l].length&&(y[v++]=o[l][d]);for(d=0;d<i;d++)for(l=0;l<e.length;l++)d<a[l].length&&(y[v++]=a[l][d]);return y};for(var r={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;s.getBCHDigit(e)-s.getBCHDigit(s.G15)>=0;)e^=s.G15<<s.getBCHDigit(e)-s.getBCHDigit(s.G15);return(t<<10|e)^s.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;s.getBCHDigit(e)-s.getBCHDigit(s.G18)>=0;)e^=s.G18<<s.getBCHDigit(e)-s.getBCHDigit(s.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return s.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case 0:return(e+n)%2==0;case 1:return e%2==0;case 2:return n%3==0;case 3:return(e+n)%3==0;case 4:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case 5:return e*n%2+e*n%3==0;case 6:return(e*n%2+e*n%3)%2==0;case 7:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new h([1],0),n=0;n<t;n++)e=e.multiply(new h([1,o.gexp(n)],0));return e},getLengthInBits:function(t,e){if(1<=e&&e<10)switch(t){case r.MODE_NUMBER:return 10;case r.MODE_ALPHA_NUM:return 9;case r.MODE_8BIT_BYTE:case r.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(e<27)switch(t){case r.MODE_NUMBER:return 12;case r.MODE_ALPHA_NUM:return 11;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(e<41))throw new Error("type:"+e);switch(t){case r.MODE_NUMBER:return 14;case r.MODE_ALPHA_NUM:return 13;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r++)for(var i=0;i<e;i++){for(var s=0,o=t.isDark(r,i),a=-1;a<=1;a++)if(!(r+a<0||e<=r+a))for(var h=-1;h<=1;h++)i+h<0||e<=i+h||0==a&&0==h||o==t.isDark(r+a,i+h)&&s++;s>5&&(n+=3+s-5)}for(r=0;r<e-1;r++)for(i=0;i<e-1;i++){var l=0;t.isDark(r,i)&&l++,t.isDark(r+1,i)&&l++,t.isDark(r,i+1)&&l++,t.isDark(r+1,i+1)&&l++,0!=l&&4!=l||(n+=3)}for(r=0;r<e;r++)for(i=0;i<e-6;i++)t.isDark(r,i)&&!t.isDark(r,i+1)&&t.isDark(r,i+2)&&t.isDark(r,i+3)&&t.isDark(r,i+4)&&!t.isDark(r,i+5)&&t.isDark(r,i+6)&&(n+=40);for(i=0;i<e;i++)for(r=0;r<e-6;r++)t.isDark(r,i)&&!t.isDark(r+1,i)&&t.isDark(r+2,i)&&t.isDark(r+3,i)&&t.isDark(r+4,i)&&!t.isDark(r+5,i)&&t.isDark(r+6,i)&&(n+=40);var u=0;for(i=0;i<e;i++)for(r=0;r<e;r++)t.isDark(r,i)&&u++;return n+Math.abs(100*u/e/e-50)/5*10}},o={glog:function(t){if(t<1)throw new Error("glog("+t+")");return o.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return o.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},a=0;a<8;a++)o.EXP_TABLE[a]=1<<a;for(a=8;a<256;a++)o.EXP_TABLE[a]=o.EXP_TABLE[a-4]^o.EXP_TABLE[a-5]^o.EXP_TABLE[a-6]^o.EXP_TABLE[a-8];for(a=0;a<255;a++)o.LOG_TABLE[o.EXP_TABLE[a]]=a;function h(t,e){if(null==t.length)throw new Error(t.length+"/"+e);for(var n=0;n<t.length&&0==t[n];)n++;this.num=new Array(t.length-n+e);for(var r=0;r<t.length-n;r++)this.num[r]=t[r+n]}function l(t,e){this.totalCount=t,this.dataCount=e}function u(){this.buffer=[],this.length=0}h.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var r=0;r<t.getLength();r++)e[n+r]^=o.gexp(o.glog(this.get(n))+o.glog(t.get(r)));return new h(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=o.glog(this.get(0))-o.glog(t.get(0)),n=new Array(this.getLength()),r=0;r<this.getLength();r++)n[r]=this.get(r);for(r=0;r<t.getLength();r++)n[r]^=o.gexp(o.glog(t.get(r))+e);return new h(n,0).mod(t)}},l.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],l.getRSBlocks=function(t,e){var n=l.getRsBlockTable(t,e);if(null==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var r=n.length/3,i=[],s=0;s<r;s++)for(var o=n[3*s+0],a=n[3*s+1],h=n[3*s+2],u=0;u<o;u++)i.push(new l(a,h));return i},l.getRsBlockTable=function(t,e){switch(e){case i.L:return l.RS_BLOCK_TABLE[4*(t-1)+0];case i.M:return l.RS_BLOCK_TABLE[4*(t-1)+1];case i.Q:return l.RS_BLOCK_TABLE[4*(t-1)+2];case i.H:return l.RS_BLOCK_TABLE[4*(t-1)+3];default:return}},u.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var c=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function d(){var t=!1,e=navigator.userAgent;if(/android/i.test(e)){t=!0;var n=e.toString().match(/android ([0-9]\.[0-9])/i);n&&n[1]&&(t=parseFloat(n[1]))}return t}var f=function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){var e=this._htOption,n=this._el,r=t.getModuleCount();function i(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg",t);for(var r in e)e.hasOwnProperty(r)&&n.setAttribute(r,e[r]);return n}Math.floor(e.width/r),Math.floor(e.height/r),this.clear();var s=i("svg",{viewBox:"0 0 "+String(r)+" "+String(r),width:"100%",height:"100%",fill:e.colorLight});s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.appendChild(s),s.appendChild(i("rect",{fill:e.colorLight,width:"100%",height:"100%"})),s.appendChild(i("rect",{fill:e.colorDark,width:"1",height:"1",id:"template"}));for(var o=0;o<r;o++)for(var a=0;a<r;a++)if(t.isDark(o,a)){var h=i("use",{x:String(a),y:String(o)});h.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),s.appendChild(h)}},t.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},t}(),p="svg"===document.documentElement.tagName.toLowerCase()?f:"undefined"==typeof CanvasRenderingContext2D?function(){var t=function(t,e){this._el=t,this._htOption=e};return t.prototype.draw=function(t){for(var e=this._htOption,n=this._el,r=t.getModuleCount(),i=Math.floor(e.width/r),s=Math.floor(e.height/r),o=['<table style="border:0;border-collapse:collapse;">'],a=0;a<r;a++){o.push("<tr>");for(var h=0;h<r;h++)o.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+s+"px;background-color:"+(t.isDark(a,h)?e.colorDark:e.colorLight)+';"></td>');o.push("</tr>")}o.push("</table>"),n.innerHTML=o.join("");var l=n.childNodes[0],u=(e.width-l.offsetWidth)/2,c=(e.height-l.offsetHeight)/2;u>0&&c>0&&(l.style.margin=c+"px "+u+"px")},t.prototype.clear=function(){this._el.innerHTML=""},t}():function(){function t(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(this._android&&this._android<=2.1){var e=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(t,r,i,s,o,a,h,l,u){if("nodeName"in t&&/img/i.test(t.nodeName))for(var c=arguments.length-1;c>=1;c--)arguments[c]=arguments[c]*e;else void 0===l&&(arguments[1]*=e,arguments[2]*=e,arguments[3]*=e,arguments[4]*=e);n.apply(this,arguments)}}function r(t,e){var n=this;if(n._fFail=e,n._fSuccess=t,null===n._bSupportDataURI){var r=document.createElement("img"),i=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)};return r.onabort=i,r.onerror=i,r.onload=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)},void(r.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===n._bSupportDataURI&&n._fSuccess?n._fSuccess.call(n):!1===n._bSupportDataURI&&n._fFail&&n._fFail.call(n)}var i=function(t,e){this._bIsPainted=!1,this._android=d(),this._htOption=e,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=e.width,this._elCanvas.height=e.height,t.appendChild(this._elCanvas),this._el=t,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(t){var e=this._elImage,n=this._oContext,r=this._htOption,i=t.getModuleCount(),s=r.width/i,o=r.height/i,a=Math.round(s),h=Math.round(o);e.style.display="none",this.clear();for(var l=0;l<i;l++)for(var u=0;u<i;u++){var c=t.isDark(l,u),d=u*s,f=l*o;n.strokeStyle=c?r.colorDark:r.colorLight,n.lineWidth=1,n.fillStyle=c?r.colorDark:r.colorLight,n.fillRect(d,f,s,o),n.strokeRect(Math.floor(d)+.5,Math.floor(f)+.5,a,h),n.strokeRect(Math.ceil(d)-.5,Math.ceil(f)-.5,a,h)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&r.call(this,t)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(t){return t?Math.floor(1e3*t)/1e3:t},i}();t=function(t,e){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H},"string"==typeof e&&(e={text:e}),e)for(var n in e)this._htOption[n]=e[n];"string"==typeof t&&(t=document.getElementById(t)),this._htOption.useSVG&&(p=f),this._android=d(),this._el=t,this._oQRCode=null,this._oDrawing=new p(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},t.prototype.makeCode=function(t){this._oQRCode=new n(function(t,e){for(var n=1,r=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)}(t),s=0,o=c.length;s<=o;s++){var a=0;switch(e){case i.L:a=c[s][0];break;case i.M:a=c[s][1];break;case i.Q:a=c[s][2];break;case i.H:a=c[s][3]}if(r<=a)break;n++}if(n>c.length)throw new Error("Too long data");return n}(t,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(t),this._oQRCode.make(),this._el.title=t,this._oDrawing.draw(this._oQRCode),this.makeImage()},t.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},t.prototype.clear=function(){this._oDrawing.clear()},t.CorrectLevel=i}()}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={id:r,exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";const t=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,h=a?t[e+2]:0,l=i>>2,u=(3&i)<<4|o>>4;let c=(15&o)<<2|h>>6,d=63&h;a||(d=64,s||(c=64)),r.push(n[l],n[u],n[c],n[d])}return r.join("")},encodeString(e,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(e):this.encodeByteArray(t(e),n)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const h=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==a||null==h)throw new r;const l=s<<2|o>>4;if(i.push(l),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==h){const t=a<<6&192|h;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class r extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i=function(n){return function(n){const r=t(n);return e.encodeByteArray(r,!0)}(n).replace(/\./g,"")},s=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const n=t&&function(t){try{return e.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return n&&JSON.parse(n)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},o=t=>{const e=(t=>{var e,n;return null===(n=null===(e=s())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},a=()=>{var t;return null===(t=s())||void 0===t?void 0:t.config};class h{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function u(){try{return"object"==typeof indexedDB}catch(t){return!1}}class c extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,c.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,d.prototype.create)}}class d{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],s=i?function(t,e){return t.replace(f,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new c(r,o,n)}}const f=/\{\$([^}]+)}/g;function p(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(g(n)&&g(s)){if(!p(n,s))return!1}else if(n!==s)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function g(t){return null!==t&&"object"==typeof t}function m(t){return t&&t._delegate?t._delegate:t}class y{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const v="[DEFAULT]";class w{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new h;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:v})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=v){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=v){return this.instances.has(t)}getOptions(t=v){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===v?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=v){return this.component?this.component.multipleInstances?t:v:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class E{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new w(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const b=[];var _;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(_||(_={}));const T={debug:_.DEBUG,verbose:_.VERBOSE,info:_.INFO,warn:_.WARN,error:_.ERROR,silent:_.SILENT},I=_.INFO,C={[_.DEBUG]:"log",[_.VERBOSE]:"log",[_.INFO]:"info",[_.WARN]:"warn",[_.ERROR]:"error"},A=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=C[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class S{constructor(t){this.name=t,this._logLevel=I,this._logHandler=A,this._userLogHandler=null,b.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in _))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?T[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,_.DEBUG,...t),this._logHandler(this,_.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,_.VERBOSE,...t),this._logHandler(this,_.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,_.INFO,...t),this._logHandler(this,_.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,_.WARN,...t),this._logHandler(this,_.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,_.ERROR,...t),this._logHandler(this,_.ERROR,...t)}}const D=(t,e)=>e.some((e=>t instanceof e));let N,k;const L=new WeakMap,O=new WeakMap,x=new WeakMap,R=new WeakMap,M=new WeakMap;let P={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return O.get(t);if("objectStoreNames"===e)return t.objectStoreNames||x.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return F(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function V(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(k||(k=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(B(this),t),F(L.get(this))}:function(...t){return F(e.apply(B(this),t))}:function(t,...n){const r=e.call(B(this),t,...n);return x.set(r,t.sort?t.sort():[t]),F(r)}:(t instanceof IDBTransaction&&function(t){if(O.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));O.set(t,e)}(t),D(t,N||(N=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,P):t);var e}function F(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(F(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&L.set(e,t)})).catch((()=>{})),M.set(e,t),e}(t);if(R.has(t))return R.get(t);const e=V(t);return e!==t&&(R.set(t,e),M.set(e,t)),e}const B=t=>M.get(t),U=["get","getKey","getAll","getAllKeys","count"],j=["put","add","delete","clear"],$=new Map;function H(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if($.get(e))return $.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=j.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!U.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&s.done]))[0]};return $.set(e,s),s}var G;G=P,P={...G,get:(t,e,n)=>H(t,e)||G.get(t,e,n),has:(t,e)=>!!H(t,e)||G.has(t,e)};class z{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const K="@firebase/app",q="0.9.26",Q=new S("@firebase/app"),X="[DEFAULT]",W={[K]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},J=new Map,Y=new Map;function Z(t,e){try{t.container.addComponent(e)}catch(n){Q.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function tt(t){const e=t.name;if(Y.has(e))return Q.debug(`There were multiple attempts to register component ${e}.`),!1;Y.set(e,t);for(const e of J.values())Z(e,t);return!0}const et=new d("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class nt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new y("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw et.create("app-deleted",{appName:this._name})}}function rt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:X,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw et.create("bad-app-name",{appName:String(i)});if(n||(n=a()),!n)throw et.create("no-options");const s=J.get(i);if(s){if(p(n,s.options)&&p(r,s.config))return s;throw et.create("duplicate-app",{appName:i})}const o=new E(i);for(const t of Y.values())o.addComponent(t);const h=new nt(n,r,o);return J.set(i,h),h}function it(t,e,n){var r;let i=null!==(r=W[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void Q.warn(t.join(" "))}tt(new y(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const st="firebase-heartbeat-database",ot=1,at="firebase-heartbeat-store";let ht=null;function lt(){return ht||(ht=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=F(o);return r&&o.addEventListener("upgradeneeded",(t=>{r(F(o.result),t.oldVersion,t.newVersion,F(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(st,ot,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(at)}catch(t){console.warn(t)}}}).catch((t=>{throw et.create("idb-open",{originalErrorMessage:t.message})}))),ht}async function ut(t,e){try{const n=(await lt()).transaction(at,"readwrite"),r=n.objectStore(at);await r.put(e,ct(t)),await n.done}catch(t){if(t instanceof c)Q.warn(t.message);else{const e=et.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});Q.warn(e.message)}}}function ct(t){return`${t.name}!${t.options.appId}`}class dt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new pt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ft();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((t=>t.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=ft(),{heartbeatsToSend:n,unsentEntries:r}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),gt(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),gt(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=i(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function ft(){return(new Date).toISOString().substring(0,10)}class pt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!u()&&new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=await lt();return await e.transaction(at).objectStore(at).get(ct(t))}catch(t){if(t instanceof c)Q.warn(t.message);else{const e=et.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});Q.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return ut(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return ut(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function gt(t){return i(JSON.stringify({version:2,heartbeats:t})).length}tt(new y("platform-logger",(t=>new z(t)),"PRIVATE")),tt(new y("heartbeat",(t=>new dt(t)),"PRIVATE")),it(K,q,""),it(K,q,"esm2017"),it("fire-js",""),it("firebase","10.7.2","app");var mt,yt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},vt={},wt=wt||{},Et=yt||self;function bt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function _t(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Tt="closure_uid_"+(1e9*Math.random()>>>0),It=0;function Ct(t,e,n){return t.call.apply(t.bind,arguments)}function At(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function St(t,e,n){return(St=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Ct:At).apply(null,arguments)}function Dt(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Nt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function kt(){this.s=this.s,this.o=this.o}kt.prototype.s=!1,kt.prototype.sa=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Tt)&&t[Tt]||(t[Tt]=++It))},kt.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Lt=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Ot(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function xt(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(bt(n)){const e=t.length||0,r=n.length||0;t.length=e+r;for(let i=0;i<r;i++)t[e+i]=n[i]}else t.push(n)}}function Rt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Rt.prototype.h=function(){this.defaultPrevented=!0};var Mt=function(){if(!Et.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};Et.addEventListener("test",t,e),Et.removeEventListener("test",t,e)}catch(t){}return t}();function Pt(t){return/^[\s\xa0]*$/.test(t)}function Vt(){var t=Et.navigator;return t&&(t=t.userAgent)?t:""}function Ft(t){return-1!=Vt().indexOf(t)}function Bt(t){return Bt[" "](t),t}Bt[" "]=function(){};var Ut,jt,$t,Ht=Ft("Opera"),Gt=Ft("Trident")||Ft("MSIE"),zt=Ft("Edge"),Kt=zt||Gt,qt=Ft("Gecko")&&!(-1!=Vt().toLowerCase().indexOf("webkit")&&!Ft("Edge"))&&!(Ft("Trident")||Ft("MSIE"))&&!Ft("Edge"),Qt=-1!=Vt().toLowerCase().indexOf("webkit")&&!Ft("Edge");function Xt(){var t=Et.document;return t?t.documentMode:void 0}t:{var Wt="",Jt=(jt=Vt(),qt?/rv:([^\);]+)(\)|;)/.exec(jt):zt?/Edge\/([\d\.]+)/.exec(jt):Gt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(jt):Qt?/WebKit\/(\S+)/.exec(jt):Ht?/(?:Version)[ \/]?(\S+)/.exec(jt):void 0);if(Jt&&(Wt=Jt?Jt[1]:""),Gt){var Yt=Xt();if(null!=Yt&&Yt>parseFloat(Wt)){Ut=String(Yt);break t}}Ut=Wt}Et.document&&Gt?$t=Xt()||parseInt(Ut,10)||void 0:$t=void 0;var Zt=$t;function te(t,e){if(Rt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(qt){t:{try{Bt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ee[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&te.$.h.call(this)}}Nt(te,Rt);var ee={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),re=0;function ie(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++re,this.fa=this.ia=!1}function se(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function oe(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function ae(t){const e={};for(const n in t)e[n]=t[n];return e}const he="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function le(t,e){let n,r;for(let e=1;e<arguments.length;e++){for(n in r=arguments[e],r)t[n]=r[n];for(let e=0;e<he.length;e++)n=he[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ue(t){this.src=t,this.g={},this.h=0}function ce(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=Lt(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(se(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function de(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}ue.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=de(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new ie(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var fe="closure_lm_"+(1e6*Math.random()|0),pe={};function ge(t,e,n,r,i){if(r&&r.once)return ye(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)ge(t,e[s],n,r,i);return null}return n=Ie(n),t&&t[ne]?t.O(e,n,_t(r)?!!r.capture:!!r,i):me(t,e,n,!1,r,i)}function me(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=_t(i)?!!i.capture:!!i,a=_e(t);if(a||(t[fe]=a=new ue(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){const t=be;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Mt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ee(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function ye(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)ye(t,e[s],n,r,i);return null}return n=Ie(n),t&&t[ne]?t.P(e,n,_t(r)?!!r.capture:!!r,i):me(t,e,n,!0,r,i)}function ve(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)ve(t,e[s],n,r,i);else r=_t(r)?!!r.capture:!!r,n=Ie(n),t&&t[ne]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=de(s=t.g[e],n,r,i))&&(se(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=_e(t))&&(e=t.g[e.toString()],t=-1,e&&(t=de(e,n,r,i)),(n=-1<t?e[t]:null)&&we(n))}function we(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[ne])ce(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ee(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_e(e))?(ce(n,t),0==n.h&&(n.src=null,e[fe]=null)):se(t)}}}function Ee(t){return t in pe?pe[t]:pe[t]="on"+t}function be(t,e){if(t.fa)t=!0;else{e=new te(e,this);var n=t.listener,r=t.la||t.src;t.ia&&we(t),t=n.call(r,e)}return t}function _e(t){return(t=t[fe])instanceof ue?t:null}var Te="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ie(t){return"function"==typeof t?t:(t[Te]||(t[Te]=function(e){return t.handleEvent(e)}),t[Te])}function Ce(){kt.call(this),this.i=new ue(this),this.S=this,this.J=null}function Ae(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new Rt(e,t);else if(e instanceof Rt)e.target=e.target||t;else{var i=e;le(e=new Rt(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Se(o,r,!0,e)&&i}if(i=Se(o=e.g=t,r,!0,e)&&i,i=Se(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=Se(o=e.g=n[s],r,!1,e)&&i}function Se(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,h=o.la||o.src;o.ia&&ce(t.i,o),i=!1!==a.call(h,r)&&i}}return i&&!r.defaultPrevented}Nt(Ce,kt),Ce.prototype[ne]=!0,Ce.prototype.removeEventListener=function(t,e,n,r){ve(this,t,e,n,r)},Ce.prototype.N=function(){if(Ce.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)se(n[r]);delete e.g[t],e.h--}}this.J=null},Ce.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Ce.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var De=Et.JSON.stringify;function Ne(){var t=Pe;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var ke=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Le),(t=>t.reset()));class Le{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Oe(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function xe(t){Et.setTimeout((()=>{throw t}),0)}let Re,Me=!1,Pe=new class{constructor(){this.h=this.g=null}add(t,e){const n=ke.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},Ve=()=>{const t=Et.Promise.resolve(void 0);Re=()=>{t.then(Fe)}};var Fe=()=>{for(var t;t=Ne();){try{t.h.call(t.g)}catch(t){xe(t)}var e=ke;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Me=!1};function Be(t,e){Ce.call(this),this.h=t||1,this.g=e||Et,this.j=St(this.qb,this),this.l=Date.now()}function Ue(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function je(t,e,n){if("function"==typeof t)n&&(t=St(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=St(t.handleEvent,t)}return 2147483647<Number(e)?-1:Et.setTimeout(t,e||0)}function $e(t){t.g=je((()=>{t.g=null,t.i&&(t.i=!1,$e(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Nt(Be,Ce),(mt=Be.prototype).ga=!1,mt.T=null,mt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Ae(this,"tick"),this.ga&&(Ue(this),this.start()))}},mt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},mt.N=function(){Be.$.N.call(this),Ue(this),delete this.g};class He extends kt{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:$e(this)}N(){super.N(),this.g&&(Et.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ge(t){kt.call(this),this.h=t,this.g={}}Nt(Ge,kt);var ze=[];function Ke(t,e,n,r){Array.isArray(n)||(n&&(ze[0]=n.toString()),n=ze);for(var i=0;i<n.length;i++){var s=ge(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function qe(t){oe(t.g,(function(t,e){this.g.hasOwnProperty(e)&&we(t)}),t),t.g={}}function Qe(){this.g=!0}function Xe(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return De(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Ge.prototype.N=function(){Ge.$.N.call(this),qe(this)},Ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qe.prototype.Ea=function(){this.g=!1},Qe.prototype.info=function(){};var We={},Je=null;function Ye(){return Je=Je||new Ce}function Ze(t){Rt.call(this,We.Ta,t)}function tn(t){const e=Ye();Ae(e,new Ze(e))}function en(t,e){Rt.call(this,We.STAT_EVENT,t),this.stat=e}function nn(t){const e=Ye();Ae(e,new en(e,t))}function rn(t,e){Rt.call(this,We.Ua,t),this.size=e}function sn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Et.setTimeout((function(){t()}),e)}We.Ta="serverreachability",Nt(Ze,Rt),We.STAT_EVENT="statevent",Nt(en,Rt),We.Ua="timingevent",Nt(rn,Rt);var on={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},an={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function hn(){}function ln(t){return t.h||(t.h=t.i())}function un(){}hn.prototype.h=null;var cn,dn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function fn(){Rt.call(this,"d")}function pn(){Rt.call(this,"c")}function gn(){}function mn(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Ge(this),this.P=vn,t=Kt?125:void 0,this.V=new Be(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new yn}function yn(){this.i=null,this.g="",this.h=!1}Nt(fn,Rt),Nt(pn,Rt),Nt(gn,hn),gn.prototype.g=function(){return new XMLHttpRequest},gn.prototype.i=function(){return{}},cn=new gn;var vn=45e3,wn={},En={};function bn(t,e,n){t.L=1,t.A=Un(Mn(e)),t.u=n,t.S=!0,_n(t,null)}function _n(t,e){t.G=Date.now(),An(t),t.B=Mn(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),Zn(n.i,"t",r),t.o=0,n=t.l.J,t.h=new yn,t.g=Zr(t.l,n?e:null,!t.u),0<t.O&&(t.M=new He(St(t.Pa,t,t.g),t.O)),Ke(t.U,t.g,"readystatechange",t.nb),e=t.I?ae(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),tn(),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),h=0;h<a.length;h++){var l=a[h].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.v,t.B,t.m,t.W,t.u)}function Tn(t){return!!t.g&&"GET"==t.v&&2!=t.L&&t.l.Ha}function In(t,e,n){let r,i=!0;for(;!t.J&&t.o<n.length;){if(r=Cn(t,n),r==En){4==e&&(t.s=4,nn(14),i=!1),Xe(t.j,t.m,null,"[Incomplete Response]");break}if(r==wn){t.s=4,nn(15),Xe(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}Xe(t.j,t.m,r,null),Ln(t,r)}Tn(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=n.length||t.h.h||(t.s=1,nn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),zr(e),e.M=!0,nn(11))):(Xe(t.j,t.m,n,"[Invalid Chunked Response]"),kn(t),Nn(t))}function Cn(t,e){var n=t.o,r=e.indexOf("\n",n);return-1==r?En:(n=Number(e.substring(n,r)),isNaN(n)?wn:(r+=1)+n>e.length?En:(e=e.slice(r,r+n),t.o=r+n,e))}function An(t){t.Y=Date.now()+t.P,Sn(t,t.P)}function Sn(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=sn(St(t.lb,t),e)}function Dn(t){t.C&&(Et.clearTimeout(t.C),t.C=null)}function Nn(t){0==t.l.H||t.J||Qr(t.l,t)}function kn(t){Dn(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Ue(t.V),qe(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Ln(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||or(n.i,t)))if(!t.K&&or(n.i,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;qr(n),Vr(n)}Gr(n),nn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=sn(St(n.ib,n),6e3));if(1>=sr(n.i)&&n.oa){try{n.oa()}catch(t){}n.oa=void 0}}else Wr(n,11)}else if((t.K||n.g==t)&&qr(n),!Pt(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.K=l[1],n.pa=l[2];const e=l[3];null!=e&&(n.ra=e,n.l.info("VER="+n.ra));const i=l[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const c=t.g;if(c){const t=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ar(s,s.h),s.h=null))}if(r.F){const t=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.Da=t,Bn(r.I,r.F,t))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=Yr(r,r.J?r.pa:null,r.Y),o.K){hr(r.i,o);var a=o,h=r.L;h&&a.setTimeout(h),a.C&&(Dn(a),An(a)),r.g=o}else Hr(r);0<n.j.length&&Br(n)}else"stop"!=l[0]&&"close"!=l[0]||Wr(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Wr(n,7):Pr(n):"noop"!=l[0]&&n.h&&n.h.Aa(l),n.A=0)}tn()}catch(t){}}function On(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(bt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(bt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(bt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(mt=mn.prototype).setTimeout=function(t){this.P=t},mt.nb=function(t){t=t.target;const e=this.M;e&&3==kr(t)?e.l():this.Pa(t)},mt.Pa=function(t){try{if(t==this.g)t:{const u=kr(this.g);var e=this.g.Ia();if(this.g.da(),!(3>u)&&(3!=u||Kt||this.g&&(this.h.h||this.g.ja()||Lr(this.g)))){this.J||4!=u||7==e||tn(),Dn(this);var n=this.g.da();this.ca=n;e:if(Tn(this)){var r=Lr(this.g);t="";var i=r.length,s=4==kr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){kn(this),Nn(this);var o="";break e}this.h.i=new Et.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,h=this.g;if((a=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pt(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.s=3,nn(12),kn(this),Nn(this);break t}Xe(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ln(this,n)}this.S?(In(this,u,o),Kt&&this.i&&3==u&&(Ke(this.U,this.V,"tick",this.mb),this.V.start())):(Xe(this.j,this.m,o,null),Ln(this,o)),4==u&&kn(this),this.i&&!this.J&&(4==u?Qr(this.l,this):(this.i=!1,An(this)))}else(function(t){const e={};t=(t.g&&2<=kr(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(Pt(t[r]))continue;var n=Oe(t[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,(function(t){return t.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,nn(12)):(this.s=0,nn(13)),kn(this),Nn(this)}}}catch(t){}},mt.mb=function(){if(this.g){var t=kr(this.g),e=this.g.ja();this.o<e.length&&(Dn(this),In(this,t,e),this.i&&4!=t&&An(this))}},mt.cancel=function(){this.J=!0,kn(this)},mt.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.B),2!=this.L&&(tn(),nn(17)),kn(this),this.s=2,Nn(this)):Sn(this,this.Y-t)};var xn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Rn(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Rn){this.h=t.h,Pn(this,t.j),this.s=t.s,this.g=t.g,Vn(this,t.m),this.l=t.l;var e=t.i,n=new Xn;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Fn(this,n),this.o=t.o}else t&&(e=String(t).match(xn))?(this.h=!1,Pn(this,e[1]||"",!0),this.s=jn(e[2]||""),this.g=jn(e[3]||"",!0),Vn(this,e[4]),this.l=jn(e[5]||"",!0),Fn(this,e[6]||"",!0),this.o=jn(e[7]||"")):(this.h=!1,this.i=new Xn(null,this.h))}function Mn(t){return new Rn(t)}function Pn(t,e,n){t.j=n?jn(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Vn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Fn(t,e,n){e instanceof Xn?(t.i=e,function(t,e){e&&!t.j&&(Wn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Jn(this,e),Zn(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=$n(e,qn)),t.i=new Xn(e,t.h))}function Bn(t,e,n){t.i.set(e,n)}function Un(t){return Bn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function jn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $n(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.j;e&&t.push($n(e,Gn,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push($n(e,Gn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push($n(n,"/"==n.charAt(0)?Kn:zn,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",$n(n,Qn)),t.join("")};var Gn=/[#\/\?@]/g,zn=/[#\?:]/g,Kn=/[#\?]/g,qn=/[#\?@]/g,Qn=/#/g;function Xn(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Wn(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Jn(t,e){Wn(t),e=tr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Yn(t,e){return Wn(t),e=tr(t,e),t.g.has(e)}function Zn(t,e,n){Jn(t,e),0<n.length&&(t.i=null,t.g.set(tr(t,e),Ot(n)),t.h+=n.length)}function tr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(mt=Xn.prototype).add=function(t,e){Wn(this),this.i=null,t=tr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},mt.forEach=function(t,e){Wn(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},mt.ta=function(){Wn(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},mt.Z=function(t){Wn(this);let e=[];if("string"==typeof t)Yn(this,t)&&(e=e.concat(this.g.get(tr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},mt.set=function(t,e){return Wn(this),this.i=null,Yn(this,t=tr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},mt.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},mt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var er=class{constructor(t,e){this.g=t,this.map=e}};function nr(t){this.l=t||rr,t=Et.PerformanceNavigationTiming?0<(t=Et.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Et.g&&Et.g.Ka&&Et.g.Ka()&&Et.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var rr=10;function ir(t){return!!t.h||!!t.g&&t.g.size>=t.j}function sr(t){return t.h?1:t.g?t.g.size:0}function or(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ar(t,e){t.g?t.g.add(e):t.h=e}function hr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function lr(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Ot(t.i)}nr.prototype.cancel=function(){if(this.i=lr(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var ur=class{stringify(t){return Et.JSON.stringify(t,void 0)}parse(t){return Et.JSON.parse(t,void 0)}};function cr(){this.g=new ur}function dr(t,e,n){const r=n||"";try{On(t,(function(t,n){let i=t;_t(t)&&(i=De(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function fr(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function pr(t){this.l=t.ec||null,this.j=t.ob||!1}function gr(t,e){Ce.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=mr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Nt(pr,hn),pr.prototype.g=function(){return new gr(this.l,this.j)},pr.prototype.i=function(t){return function(){return t}}({}),Nt(gr,Ce);var mr=0;function yr(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function vr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,wr(t)}function wr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(mt=gr.prototype).open=function(t,e){if(this.readyState!=mr)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,wr(this)},mt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Et).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},mt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,vr(this)),this.readyState=mr},mt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,wr(this)),this.g&&(this.readyState=3,wr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Et.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;yr(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},mt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?vr(this):wr(this),3==this.readyState&&yr(this)}},mt.Za=function(t){this.g&&(this.response=this.responseText=t,vr(this))},mt.Ya=function(t){this.g&&(this.response=t,vr(this))},mt.ka=function(){this.g&&vr(this)},mt.setRequestHeader=function(t,e){this.v.append(t,e)},mt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},mt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(gr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Er=Et.JSON.parse;function br(t){Ce.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=_r,this.L=this.M=!1}Nt(br,Ce);var _r="",Tr=/^https?$/i,Ir=["POST","PUT"];function Cr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ar(t),Dr(t)}function Ar(t){t.F||(t.F=!0,Ae(t,"complete"),Ae(t,"error"))}function Sr(t){if(t.h&&void 0!==wt&&(!t.C[1]||4!=kr(t)||2!=t.da()))if(t.v&&4==kr(t))je(t.La,0,t);else if(Ae(t,"readystatechange"),4==kr(t)){t.h=!1;try{const o=t.da();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===o){var i=String(t.I).match(xn)[1]||null;!i&&Et.self&&Et.self.location&&(i=Et.self.location.protocol.slice(0,-1)),r=!Tr.test(i?i.toLowerCase():"")}n=r}if(n)Ae(t,"complete"),Ae(t,"success");else{t.m=6;try{var s=2<kr(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.da()+"]",Ar(t)}}finally{Dr(t)}}}function Dr(t,e){if(t.g){Nr(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Ae(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Nr(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Et.clearTimeout(t.A),t.A=null)}function kr(t){return t.g?t.g.readyState:0}function Lr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case _r:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Or(t){let e="";return oe(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function xr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Or(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Bn(t,e,n))}function Rr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Mr(t){this.Ga=0,this.j=[],this.l=new Qe,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Rr("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Rr("baseRetryDelayMs",5e3,t),this.hb=Rr("retryDelaySeedMs",1e4,t),this.eb=Rr("forwardChannelMaxRetries",2,t),this.xa=Rr("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new nr(t&&t.concurrentRequestLimit),this.Ja=new cr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Pr(t){if(Fr(t),3==t.H){var e=t.W++,n=Mn(t.I);if(Bn(n,"SID",t.K),Bn(n,"RID",e),Bn(n,"TYPE","terminate"),jr(t,n),(e=new mn(t,t.l,e)).L=2,e.A=Un(Mn(n)),n=!1,Et.navigator&&Et.navigator.sendBeacon)try{n=Et.navigator.sendBeacon(e.A.toString(),"")}catch(t){}!n&&Et.Image&&((new Image).src=e.A,n=!0),n||(e.g=Zr(e.l,null),e.g.ha(e.A)),e.G=Date.now(),An(e)}Jr(t)}function Vr(t){t.g&&(zr(t),t.g.cancel(),t.g=null)}function Fr(t){Vr(t),t.u&&(Et.clearTimeout(t.u),t.u=null),qr(t),t.i.cancel(),t.m&&("number"==typeof t.m&&Et.clearTimeout(t.m),t.m=null)}function Br(t){if(!ir(t.i)&&!t.m){t.m=!0;var e=t.Na;Re||Ve(),Me||(Re(),Me=!0),Pe.add(e,t),t.C=0}}function Ur(t,e){var n;n=e?e.m:t.W++;const r=Mn(t.I);Bn(r,"SID",t.K),Bn(r,"RID",n),Bn(r,"AID",t.V),jr(t,r),t.o&&t.s&&xr(r,t.o,t.s),n=new mn(t,t.l,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=$r(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),ar(t.i,n),bn(n,r,e)}function jr(t,e){t.na&&oe(t.na,(function(t,n){Bn(e,n,t)})),t.h&&On({},(function(t,n){Bn(e,n,t)}))}function $r(t,e,n){n=Math.min(t.j.length,n);var r=t.h?St(t.h.Va,t.h,t):null;t:{var i=t.j;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=e,0>n)e=Math.max(0,i[o].g-100),s=!1;else try{dr(a,t,"req"+n+"_")}catch(t){r&&r(a)}}if(s){r=t.join("&");break t}}}return t=t.j.splice(0,n),e.F=t,r}function Hr(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Re||Ve(),Me||(Re(),Me=!0),Pe.add(e,t),t.A=0}}function Gr(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=sn(St(t.Ma,t),Xr(t,t.A)),t.A++,0))}function zr(t){null!=t.B&&(Et.clearTimeout(t.B),t.B=null)}function Kr(t){t.g=new mn(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Mn(t.wa);Bn(e,"RID","rpc"),Bn(e,"SID",t.K),Bn(e,"AID",t.V),Bn(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Bn(e,"TO",t.qa),Bn(e,"TYPE","xmlhttp"),jr(t,e),t.o&&t.s&&xr(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Un(Mn(e)),n.u=null,n.S=!0,_n(n,t)}function qr(t){null!=t.v&&(Et.clearTimeout(t.v),t.v=null)}function Qr(t,e){var n=null;if(t.g==e){qr(t),zr(t),t.g=null;var r=2}else{if(!or(t.i,e))return;n=e.F,hr(t.i,e),r=1}if(0!=t.H)if(e.i)if(1==r){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;Ae(r=Ye(),new rn(r,n)),Br(t)}else Hr(t);else if(3==(i=e.s)||0==i&&0<e.ca||!(1==r&&function(t,e){return!(sr(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.j=e.F.concat(t.j),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=sn(St(t.Na,t,e),Xr(t,t.C)),t.C++,0)))}(t,e)||2==r&&Gr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Wr(t,5);break;case 4:Wr(t,10);break;case 3:Wr(t,6);break;default:Wr(t,2)}}function Xr(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Wr(t,e){if(t.l.info("Error code "+e),2==e){var n=null;t.h&&(n=null);var r=St(t.pb,t);n||(n=new Rn("//www.google.com/images/cleardot.gif"),Et.location&&"http"==Et.location.protocol||Pn(n,"https"),Un(n)),function(t,e){const n=new Qe;if(Et.Image){const r=new Image;r.onload=Dt(fr,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Dt(fr,n,r,"TestLoadImage: error",!1,e),r.onabort=Dt(fr,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Dt(fr,n,r,"TestLoadImage: timeout",!1,e),Et.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else nn(2);t.H=0,t.h&&t.h.za(e),Jr(t),Fr(t)}function Jr(t){if(t.H=0,t.ma=[],t.h){const e=lr(t.i);0==e.length&&0==t.j.length||(xt(t.ma,e),xt(t.ma,t.j),t.i.i.length=0,Ot(t.j),t.j.length=0),t.h.ya()}}function Yr(t,e,n){var r=n instanceof Rn?Mn(n):new Rn(n);if(""!=r.g)e&&(r.g=e+"."+r.g),Vn(r,r.m);else{var i=Et.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Rn(null);r&&Pn(s,r),e&&(s.g=e),i&&Vn(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Bn(r,n,e),Bn(r,"VER",t.ra),jr(t,r),r}function Zr(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new br(new pr({ob:n})):new br(t.va)).Oa(t.J),e}function ti(){}function ei(){if(Gt&&!(10<=Number(Zt)))throw Error("Environmental error: no available transport.")}function ni(t,e){Ce.call(this),this.g=new Mr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Pt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Pt(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new si(this)}function ri(t){fn.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ii(){pn.call(this),this.status=1}function si(t){this.g=t}function oi(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function ai(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function hi(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(mt=br.prototype).Oa=function(t){this.M=t},mt.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():cn.g(),this.C=this.u?ln(this.u):ln(cn),this.g.onreadystatechange=St(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Cr(this,t)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=Et.FormData&&t instanceof Et.FormData,!(0<=Lt(Ir,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Nr(this),0<this.B&&((this.L=function(t){return Gt&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=St(this.ua,this)):this.A=je(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Cr(this,t)}},mt.ua=function(){void 0!==wt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ae(this,"timeout"),this.abort(8))},mt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Ae(this,"complete"),Ae(this,"abort"),Dr(this))},mt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dr(this,!0)),br.$.N.call(this)},mt.La=function(){this.s||(this.G||this.v||this.l?Sr(this):this.kb())},mt.kb=function(){Sr(this)},mt.isActive=function(){return!!this.g},mt.da=function(){try{return 2<kr(this)?this.g.status:-1}catch(t){return-1}},mt.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},mt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Er(e)}},mt.Ia=function(){return this.m},mt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(mt=Mr.prototype).ra=8,mt.H=1,mt.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new mn(this,this.l,t);let s=this.s;if(this.U&&(s?(s=ae(s),le(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.j.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=$r(this,i,e),Bn(n=Mn(this.I),"RID",t),Bn(n,"CVER",22),this.F&&Bn(n,"X-HTTP-Session-Id",this.F),jr(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Or(s)))+"&"+e:this.o&&xr(n,this.o,s)),ar(this.i,i),this.bb&&Bn(n,"TYPE","init"),this.P?(Bn(n,"$req",e),Bn(n,"SID","null"),i.aa=!0,bn(i,n,null)):bn(i,n,e),this.H=2}}else 3==this.H&&(t?Ur(this,t):0==this.j.length||ir(this.i)||Ur(this))},mt.Ma=function(){if(this.u=null,Kr(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=sn(St(this.jb,this),t)}},mt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,nn(10),Vr(this),Kr(this))},mt.ib=function(){null!=this.v&&(this.v=null,Vr(this),Gr(this),nn(19))},mt.pb=function(t){t?(this.l.info("Successfully pinged google.com"),nn(2)):(this.l.info("Failed to ping google.com"),nn(1))},mt.isActive=function(){return!!this.h&&this.h.isActive(this)},(mt=ti.prototype).Ba=function(){},mt.Aa=function(){},mt.za=function(){},mt.ya=function(){},mt.isActive=function(){return!0},mt.Va=function(){},ei.prototype.g=function(t,e){return new ni(t,e)},Nt(ni,Ce),ni.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;nn(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Yr(t,null,t.Y),Br(t)},ni.prototype.close=function(){Pr(this.g)},ni.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=De(t),t=n);e.j.push(new er(e.fb++,t)),3==e.H&&Br(e)},ni.prototype.N=function(){this.g.h=null,delete this.j,Pr(this.g),delete this.g,ni.$.N.call(this)},Nt(ri,fn),Nt(ii,pn),Nt(si,ti),si.prototype.Ba=function(){Ae(this.g,"a")},si.prototype.Aa=function(t){Ae(this.g,new ri(t))},si.prototype.za=function(t){Ae(this.g,new ii)},si.prototype.ya=function(){Ae(this.g,"b")},Nt(oi,(function(){this.blockSize=-1})),oi.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},oi.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)ai(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){ai(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){ai(this,r),i=0;break}}this.h=i,this.i+=e},oi.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var li={};function ui(t){return-128<=t&&128>t?function(t,e){var n=li;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=function(t){return new hi([0|t],0>t?-1:0)}(t)}(t):new hi([0|t],0>t?-1:0)}function ci(t){if(isNaN(t)||!isFinite(t))return fi;if(0>t)return vi(ci(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=di;return new hi(e,0)}var di=4294967296,fi=ui(0),pi=ui(1),gi=ui(16777216);function mi(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function yi(t){return-1==t.h}function vi(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new hi(n,~t.h).add(pi)}function wi(t,e){return t.add(vi(e))}function Ei(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function bi(t,e){this.g=t,this.h=e}function _i(t,e){if(mi(e))throw Error("division by zero");if(mi(t))return new bi(fi,fi);if(yi(t))return e=_i(vi(t),e),new bi(vi(e.g),vi(e.h));if(yi(e))return e=_i(t,vi(e)),new bi(vi(e.g),e.h);if(30<t.g.length){if(yi(t)||yi(e))throw Error("slowDivide_ only works with positive integers.");for(var n=pi,r=e;0>=r.X(t);)n=Ti(n),r=Ti(r);var i=Ii(n,1),s=Ii(r,1);for(r=Ii(r,2),n=Ii(n,2);!mi(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ii(r,1),n=Ii(n,1)}return e=wi(t,i.R(e)),new bi(i,e)}for(i=fi;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=ci(n)).R(e);yi(o)||0<o.X(t);)o=(s=ci(n-=r)).R(e);mi(s)&&(s=pi),i=i.add(s),t=wi(t,o)}return new bi(i,t)}function Ti(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new hi(n,t.h)}function Ii(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new hi(i,t.h)}(mt=hi.prototype).ea=function(){if(yi(this))return-vi(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:di+r)*e,e*=di}return t},mt.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(mi(this))return"0";if(yi(this))return"-"+vi(this).toString(t);for(var e=ci(Math.pow(t,6)),n=this,r="";;){var i=_i(n,e).g,s=((0<(n=wi(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(mi(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},mt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},mt.X=function(t){return yi(t=wi(this,t))?-1:mi(t)?0:1},mt.abs=function(){return yi(this)?vi(this):this},mt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new hi(n,-2147483648&n[n.length-1]?-1:0)},mt.R=function(t){if(mi(this)||mi(t))return fi;if(yi(this))return yi(t)?vi(this).R(vi(t)):vi(vi(this).R(t));if(yi(t))return vi(this.R(vi(t)));if(0>this.X(gi)&&0>t.X(gi))return ci(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,h=65535&t.D(i);n[2*r+2*i]+=o*h,Ei(n,2*r+2*i),n[2*r+2*i+1]+=s*h,Ei(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Ei(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Ei(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new hi(n,0)},mt.gb=function(t){return _i(this,t).h},mt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new hi(n,this.h&t.h)},mt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new hi(n,this.h|t.h)},mt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new hi(n,this.h^t.h)},ei.prototype.createWebChannel=ei.prototype.g,ni.prototype.send=ni.prototype.u,ni.prototype.open=ni.prototype.m,ni.prototype.close=ni.prototype.close,on.NO_ERROR=0,on.TIMEOUT=8,on.HTTP_ERROR=6,an.COMPLETE="complete",un.EventType=dn,dn.OPEN="a",dn.CLOSE="b",dn.ERROR="c",dn.MESSAGE="d",Ce.prototype.listen=Ce.prototype.O,br.prototype.listenOnce=br.prototype.P,br.prototype.getLastError=br.prototype.Sa,br.prototype.getLastErrorCode=br.prototype.Ia,br.prototype.getStatus=br.prototype.da,br.prototype.getResponseJson=br.prototype.Wa,br.prototype.getResponseText=br.prototype.ja,br.prototype.send=br.prototype.ha,br.prototype.setWithCredentials=br.prototype.Oa,oi.prototype.digest=oi.prototype.l,oi.prototype.reset=oi.prototype.reset,oi.prototype.update=oi.prototype.j,hi.prototype.add=hi.prototype.add,hi.prototype.multiply=hi.prototype.R,hi.prototype.modulo=hi.prototype.gb,hi.prototype.compare=hi.prototype.X,hi.prototype.toNumber=hi.prototype.ea,hi.prototype.toString=hi.prototype.toString,hi.prototype.getBits=hi.prototype.D,hi.fromNumber=ci,hi.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return vi(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=ci(Math.pow(n,8)),i=fi,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=ci(Math.pow(n,o)),i=i.R(o).add(ci(a))):i=(i=i.R(r)).add(ci(a))}return i};var Ci=vt.createWebChannelTransport=function(){return new ei},Ai=vt.getStatEventTarget=function(){return Ye()},Si=vt.ErrorCode=on,Di=vt.EventType=an,Ni=vt.Event=We,ki=vt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Li=(vt.FetchXmlHttpFactory=pr,vt.WebChannel=un),Oi=vt.XhrIo=br,xi=(vt.Md5=oi,vt.Integer=hi);const Ri="@firebase/firestore";class Mi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Mi.UNAUTHENTICATED=new Mi(null),Mi.GOOGLE_CREDENTIALS=new Mi("google-credentials-uid"),Mi.FIRST_PARTY=new Mi("first-party-uid"),Mi.MOCK_USER=new Mi("mock-user");let Pi="10.7.2";const Vi=new S("@firebase/firestore");function Fi(){return Vi.logLevel}function Bi(t,...e){if(Vi.logLevel<=_.DEBUG){const n=e.map($i);Vi.debug(`Firestore (${Pi}): ${t}`,...n)}}function Ui(t,...e){if(Vi.logLevel<=_.ERROR){const n=e.map($i);Vi.error(`Firestore (${Pi}): ${t}`,...n)}}function ji(t,...e){if(Vi.logLevel<=_.WARN){const n=e.map($i);Vi.warn(`Firestore (${Pi}): ${t}`,...n)}}function $i(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function Hi(t="Unexpected state"){const e=`FIRESTORE (${Pi}) INTERNAL ASSERTION FAILED: `+t;throw Ui(e),new Error(e)}function Gi(t,e){t||Hi()}function zi(t,e){return t}const Ki={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qi extends c{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Qi{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Xi{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Wi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Mi.UNAUTHENTICATED)))}shutdown(){}}class Ji{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Yi{constructor(t){this.t=t,this.currentUser=Mi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new Qi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Qi,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{Bi("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Bi("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Qi)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Bi("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Gi("string"==typeof e.accessToken),new Xi(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Gi(null===t||"string"==typeof t),new Mi(t)}}class Zi{constructor(t,e,n){this.l=t,this.h=e,this.P=n,this.type="FirstParty",this.user=Mi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ts{constructor(t,e,n){this.l=t,this.h=e,this.P=n}getToken(){return Promise.resolve(new Zi(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable((()=>e(Mi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class es{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ns{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){const n=t=>{null!=t.error&&Bi("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.R;return this.R=t.token,Bi("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const r=t=>{Bi("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.A.onInit((t=>r(t))),setTimeout((()=>{if(!this.appCheck){const t=this.A.getImmediate({optional:!0});t?r(t):Bi("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Gi("string"==typeof t.token),this.R=t.token,new es(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function rs(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class is{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=rs(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function ss(t,e){return t<e?-1:t>e?1:0}function os(t,e,n){return t.length===e.length&&t.every(((t,r)=>n(t,e[r])))}class as{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new qi(Ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new qi(Ki.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new qi(Ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new qi(Ki.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return as.fromMillis(Date.now())}static fromDate(t){return as.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new as(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?ss(this.nanoseconds,t.nanoseconds):ss(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class hs{constructor(t){this.timestamp=t}static fromTimestamp(t){return new hs(t)}static min(){return new hs(new as(0,0))}static max(){return new hs(new as(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class ls{constructor(t,e,n){void 0===e?e=0:e>t.length&&Hi(),void 0===n?n=t.length-e:n>t.length-e&&Hi(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===ls.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof ls?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class us extends ls{construct(t,e,n){return new us(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new qi(Ki.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new us(e)}static emptyPath(){return new us([])}}const cs=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ds extends ls{construct(t,e,n){return new ds(t,e,n)}static isValidIdentifier(t){return cs.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ds.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ds(["__name__"])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new qi(Ki.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new qi(Ki.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new qi(Ki.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new qi(Ki.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ds(e)}static emptyPath(){return new ds([])}}class fs{constructor(t){this.path=t}static fromPath(t){return new fs(us.fromString(t))}static fromName(t){return new fs(us.fromString(t).popFirst(5))}static empty(){return new fs(us.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===us.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return us.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new fs(new us(t.slice()))}}function ps(t){return new gs(t.readTime,t.key,-1)}class gs{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new gs(hs.min(),fs.empty(),-1)}static max(){return new gs(hs.max(),fs.empty(),-1)}}function ms(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=fs.comparator(t.documentKey,e.documentKey),0!==n?n:ss(t.largestBatchId,e.largestBatchId))}const ys="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vs{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function ws(t){if(t.code!==Ki.FAILED_PRECONDITION||t.message!==ys)throw t;Bi("LocalStore","Unexpectedly lost primary lease")}class Es{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Hi(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Es(((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Es?e:Es.resolve(e)}catch(t){return Es.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Es.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Es.reject(e)}static resolve(t){return new Es(((e,n)=>{e(t)}))}static reject(t){return new Es(((e,n)=>{n(t)}))}static waitFor(t){return new Es(((e,n)=>{let r=0,i=0,s=!1;t.forEach((t=>{++r,t.next((()=>{++i,s&&i===r&&e()}),(t=>n(t)))})),s=!0,i===r&&e()}))}static or(t){let e=Es.resolve(!1);for(const n of t)e=e.next((t=>t?Es.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,r)=>{n.push(e.call(this,t,r))})),this.waitFor(n)}static mapArray(t,e){return new Es(((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const h=a;e(t[h]).next((t=>{s[h]=t,++o,o===i&&n(s)}),(t=>r(t)))}}))}static doWhile(t,e){return new Es(((n,r)=>{const i=()=>{!0===t()?e().next((()=>{i()}),r):n()};i()}))}}class bs{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new Qi,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Is(t,e.error)):this.V.resolve()},this.transaction.onerror=e=>{const n=Ns(e.target.error);this.V.reject(new Is(t,n))}}static open(t,e,n,r){try{return new bs(e,t.transaction(r,n))}catch(t){throw new Is(e,t)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(Bi("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const t=this.transaction;this.aborted||"function"!=typeof t.commit||t.commit()}store(t){const e=this.transaction.objectStore(t);return new As(e)}}class _s{constructor(t,e,n){this.name=t,this.version=e,this.p=n,12.2===_s.S(l())&&Ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return Bi("SimpleDb","Removing database:",t),Ss(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!u())return!1;if(_s.C())return!0;const t=l(),e=_s.S(t),n=0<e&&e<10,r=_s.v(t),i=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||n||i)}static C(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(t,e){return t.store(e)}static S(t){const e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(t){return this.db||(Bi("SimpleDb","Opening database:",this.name),this.db=await new Promise(((e,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=t=>{const n=t.target.result;e(n)},r.onblocked=()=>{n(new Is(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=e=>{const r=e.target.error;"VersionError"===r.name?n(new qi(Ki.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new qi(Ki.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Is(t,r))},r.onupgradeneeded=t=>{Bi("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',t.oldVersion);const e=t.target.result;this.p.N(e,r.transaction,t.oldVersion,this.version).next((()=>{Bi("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.B&&(this.db.onversionchange=t=>this.B(t)),this.db}L(t){this.B=t,this.db&&(this.db.onversionchange=e=>t(e))}async runTransaction(t,e,n,r){const i="readonly"===e;let s=0;for(;;){++s;try{this.db=await this.O(t);const e=bs.open(this.db,t,i?"readonly":"readwrite",n),s=r(e).next((t=>(e.g(),t))).catch((t=>(e.abort(t),Es.reject(t)))).toPromise();return s.catch((()=>{})),await e.m,s}catch(t){const e=t,n="FirebaseError"!==e.name&&s<3;if(Bi("SimpleDb","Transaction failed with error:",e.message,"Retrying:",n),this.close(),!n)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class Ts{constructor(t){this.k=t,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(t){this.k=t}done(){this.q=!0}U(t){this.K=t}delete(){return Ss(this.k.delete())}}class Is extends qi{constructor(t,e){super(Ki.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}}function Cs(t){return"IndexedDbTransactionError"===t.name}class As{constructor(t){this.store=t}put(t,e){let n;return void 0!==e?(Bi("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Bi("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ss(n)}add(t){return Bi("SimpleDb","ADD",this.store.name,t,t),Ss(this.store.add(t))}get(t){return Ss(this.store.get(t)).next((e=>(void 0===e&&(e=null),Bi("SimpleDb","GET",this.store.name,t,e),e)))}delete(t){return Bi("SimpleDb","DELETE",this.store.name,t),Ss(this.store.delete(t))}count(){return Bi("SimpleDb","COUNT",this.store.name),Ss(this.store.count())}W(t,e){const n=this.options(t,e),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const t=r.getAll(n.range);return new Es(((e,n)=>{t.onerror=t=>{n(t.target.error)},t.onsuccess=t=>{e(t.target.result)}}))}{const t=this.cursor(n),e=[];return this.G(t,((t,n)=>{e.push(n)})).next((()=>e))}}j(t,e){const n=this.store.getAll(t,null===e?void 0:e);return new Es(((t,e)=>{n.onerror=t=>{e(t.target.error)},n.onsuccess=e=>{t(e.target.result)}}))}H(t,e){Bi("SimpleDb","DELETE ALL",this.store.name);const n=this.options(t,e);n.J=!1;const r=this.cursor(n);return this.G(r,((t,e,n)=>n.delete()))}Y(t,e){let n;e?n=t:(n={},e=t);const r=this.cursor(n);return this.G(r,e)}Z(t){const e=this.cursor({});return new Es(((n,r)=>{e.onerror=t=>{const e=Ns(t.target.error);r(e)},e.onsuccess=e=>{const r=e.target.result;r?t(r.primaryKey,r.value).next((t=>{t?r.continue():n()})):n()}}))}G(t,e){const n=[];return new Es(((r,i)=>{t.onerror=t=>{i(t.target.error)},t.onsuccess=t=>{const i=t.target.result;if(!i)return void r();const s=new Ts(i),o=e(i.primaryKey,i.value,s);if(o instanceof Es){const t=o.catch((t=>(s.done(),Es.reject(t))));n.push(t)}s.isDone?r():null===s.$?i.continue():i.continue(s.$)}})).next((()=>Es.waitFor(n)))}options(t,e){let n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){const n=this.store.index(t.index);return t.J?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}}function Ss(t){return new Es(((e,n)=>{t.onsuccess=t=>{const n=t.target.result;e(n)},t.onerror=t=>{const e=Ns(t.target.error);n(e)}}))}let Ds=!1;function Ns(t){const e=_s.S(l());if(e>=12.2&&e<13){const e="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(e)>=0){const t=new qi("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ds||(Ds=!0,setTimeout((()=>{throw t}),0)),t}}return t}class ks{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.se(t),this.oe=t=>e.writeSequenceNumber(t))}se(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.oe&&this.oe(t),t}}function Ls(t){return null==t}function Os(t){return 0===t&&1/t==-1/0}ks._e=-1;function xs(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Rs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ms(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ps{constructor(t,e){this.comparator=t,this.root=e||Fs.EMPTY}insert(t,e){return new Ps(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Fs.BLACK,null,null))}remove(t){return new Ps(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Fs.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new Vs(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new Vs(this.root,t,this.comparator,!1)}getReverseIterator(){return new Vs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new Vs(this.root,t,this.comparator,!0)}}class Vs{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class Fs{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Fs.RED,this.left=null!=r?r:Fs.EMPTY,this.right=null!=i?i:Fs.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new Fs(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fs.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return Fs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Fs.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Fs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Hi();if(this.right.isRed())throw Hi();const t=this.left.check();if(t!==this.right.check())throw Hi();return t+(this.isRed()?0:1)}}Fs.EMPTY=null,Fs.RED=!0,Fs.BLACK=!1,Fs.EMPTY=new class{constructor(){this.size=0}get key(){throw Hi()}get value(){throw Hi()}get color(){throw Hi()}get left(){throw Hi()}get right(){throw Hi()}copy(t,e,n,r,i){return this}insert(t,e,n){return new Fs(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Bs{constructor(t){this.comparator=t,this.data=new Ps(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Us(this.data.getIterator())}getIteratorFrom(t){return new Us(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof Bs))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Bs(this.comparator);return e.data=t,e}}class Us{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class js{constructor(t){this.fields=t,t.sort(ds.comparator)}static empty(){return new js([])}unionWith(t){let e=new Bs(ds.comparator);for(const t of this.fields)e=e.add(t);for(const n of t)e=e.add(n);return new js(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return os(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class $s extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hs{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new $s("Invalid base64 string: "+t):t}}(t);return new Hs(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new Hs(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ss(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Hs.EMPTY_BYTE_STRING=new Hs("");const Gs=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zs(t){if(Gi(!!t),"string"==typeof t){let e=0;const n=Gs.exec(t);if(Gi(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ks(t.seconds),nanos:Ks(t.nanos)}}function Ks(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qs(t){return"string"==typeof t?Hs.fromBase64String(t):Hs.fromUint8Array(t)}function Qs(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Xs(t){const e=t.mapValue.fields.__previous_value__;return Qs(e)?Xs(e):e}function Ws(t){const e=zs(t.mapValue.fields.__local_write_time__.timestampValue);return new as(e.seconds,e.nanos)}class Js{constructor(t,e,n,r,i,s,o,a,h){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=h}}class Ys{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Ys("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Ys&&t.projectId===this.projectId&&t.database===this.database}}const Zs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function to(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Qs(t)?4:co(t)?9007199254740991:10:Hi()}function eo(t,e){if(t===e)return!0;const n=to(t);if(n!==to(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ws(t).isEqual(Ws(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=zs(t.timestampValue),r=zs(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return qs(t.bytesValue).isEqual(qs(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Ks(t.geoPointValue.latitude)===Ks(e.geoPointValue.latitude)&&Ks(t.geoPointValue.longitude)===Ks(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ks(t.integerValue)===Ks(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=Ks(t.doubleValue),r=Ks(e.doubleValue);return n===r?Os(n)===Os(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return os(t.arrayValue.values||[],e.arrayValue.values||[],eo);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(xs(n)!==xs(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!eo(n[t],r[t])))return!1;return!0}(t,e);default:return Hi()}}function no(t,e){return void 0!==(t.values||[]).find((t=>eo(t,e)))}function ro(t,e){if(t===e)return 0;const n=to(t),r=to(e);if(n!==r)return ss(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ss(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=Ks(t.integerValue||t.doubleValue),r=Ks(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return io(t.timestampValue,e.timestampValue);case 4:return io(Ws(t),Ws(e));case 5:return ss(t.stringValue,e.stringValue);case 6:return function(t,e){const n=qs(t),r=qs(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=ss(n[t],r[t]);if(0!==e)return e}return ss(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=ss(Ks(t.latitude),Ks(e.latitude));return 0!==n?n:ss(Ks(t.longitude),Ks(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=ro(n[t],r[t]);if(e)return e}return ss(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===Zs.mapValue&&e===Zs.mapValue)return 0;if(t===Zs.mapValue)return 1;if(e===Zs.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let t=0;t<r.length&&t<s.length;++t){const e=ss(r[t],s[t]);if(0!==e)return e;const o=ro(n[r[t]],i[s[t]]);if(0!==o)return o}return ss(r.length,s.length)}(t.mapValue,e.mapValue);default:throw Hi()}}function io(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ss(t,e);const n=zs(t),r=zs(e),i=ss(n.seconds,r.seconds);return 0!==i?i:ss(n.nanos,r.nanos)}function so(t){return oo(t)}function oo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=zs(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return qs(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return fs.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return`geo(${t.latitude},${t.longitude})`}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=oo(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+=`${i}:${oo(t.fields[i])}`;return n+"}"}(t.mapValue):Hi()}function ao(t){return!!t&&"integerValue"in t}function ho(t){return!!t&&"arrayValue"in t}function lo(t){return!!t&&"mapValue"in t}function uo(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Rs(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=uo(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=uo(t.arrayValue.values[n]);return e}return Object.assign({},t)}function co(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class fo{constructor(t){this.value=t}static empty(){return new fo({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!lo(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=uo(e)}setAll(t){let e=ds.emptyPath(),n={},r=[];t.forEach(((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=uo(t):r.push(i.lastSegment())}));const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());lo(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return eo(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];lo(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){Rs(e,((e,n)=>t[e]=n));for(const e of n)delete t[e]}clone(){return new fo(uo(this.value))}}function po(t){const e=[];return Rs(t.fields,((t,n)=>{const r=new ds([t]);if(lo(n)){const t=po(n.mapValue).fields;if(0===t.length)e.push(r);else for(const n of t)e.push(r.child(n))}else e.push(r)})),new js(e)}class go{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new go(t,0,hs.min(),hs.min(),hs.min(),fo.empty(),0)}static newFoundDocument(t,e,n,r){return new go(t,1,e,hs.min(),n,r,0)}static newNoDocument(t,e){return new go(t,2,e,hs.min(),hs.min(),fo.empty(),0)}static newUnknownDocument(t,e){return new go(t,3,e,hs.min(),hs.min(),fo.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(hs.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=fo.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=fo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=hs.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof go&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new go(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class mo{constructor(t,e){this.position=t,this.inclusive=e}}function yo(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?fs.comparator(fs.fromName(o.referenceValue),n.key):ro(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function vo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!eo(t.position[n],e.position[n]))return!1;return!0}class wo{constructor(t,e="asc"){this.field=t,this.dir=e}}function Eo(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class bo{}class _o extends bo{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new No(t,e,n):"array-contains"===e?new xo(t,n):"in"===e?new Ro(t,n):"not-in"===e?new Mo(t,n):"array-contains-any"===e?new Po(t,n):new _o(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new ko(t,n):new Lo(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.matchesComparison(ro(e,this.value)):null!==e&&to(this.value)===to(e)&&this.matchesComparison(ro(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Hi()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class To extends bo{constructor(t,e){super(),this.filters=t,this.op=e,this.ue=null}static create(t,e){return new To(t,e)}matches(t){return Io(this)?void 0===this.filters.find((e=>!e.matches(t))):void 0!==this.filters.find((e=>e.matches(t)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Io(t){return"and"===t.op}function Co(t){return function(t){for(const e of t.filters)if(e instanceof To)return!1;return!0}(t)&&Io(t)}function Ao(t){if(t instanceof _o)return t.field.canonicalString()+t.op.toString()+so(t.value);if(Co(t))return t.filters.map((t=>Ao(t))).join(",");{const e=t.filters.map((t=>Ao(t))).join(",");return`${t.op}(${e})`}}function So(t,e){return t instanceof _o?function(t,e){return e instanceof _o&&t.op===e.op&&t.field.isEqual(e.field)&&eo(t.value,e.value)}(t,e):t instanceof To?function(t,e){return e instanceof To&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce(((t,n,r)=>t&&So(n,e.filters[r])),!0)}(t,e):void Hi()}function Do(t){return t instanceof _o?function(t){return`${t.field.canonicalString()} ${t.op} ${so(t.value)}`}(t):t instanceof To?function(t){return t.op.toString()+" {"+t.getFilters().map(Do).join(" ,")+"}"}(t):"Filter"}class No extends _o{constructor(t,e,n){super(t,e,n),this.key=fs.fromName(n.referenceValue)}matches(t){const e=fs.comparator(t.key,this.key);return this.matchesComparison(e)}}class ko extends _o{constructor(t,e){super(t,"in",e),this.keys=Oo(0,e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class Lo extends _o{constructor(t,e){super(t,"not-in",e),this.keys=Oo(0,e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Oo(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>fs.fromName(t.referenceValue)))}class xo extends _o{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return ho(e)&&no(e.arrayValue,this.value)}}class Ro extends _o{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&no(this.value.arrayValue,e)}}class Mo extends _o{constructor(t,e){super(t,"not-in",e)}matches(t){if(no(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!no(this.value.arrayValue,e)}}class Po extends _o{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!ho(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>no(this.value.arrayValue,t)))}}class Vo{constructor(t,e=null,n=[],r=[],i=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ce=null}}function Fo(t,e=null,n=[],r=[],i=null,s=null,o=null){return new Vo(t,e,n,r,i,s,o)}function Bo(t){const e=zi(t);if(null===e.ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>Ao(t))).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Ls(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>so(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>so(t))).join(",")),e.ce=t}return e.ce}function Uo(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Eo(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!So(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vo(t.startAt,e.startAt)&&vo(t.endAt,e.endAt)}class jo{constructor(t,e=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function $o(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function Ho(t){const e=zi(t);if(null===e.le){e.le=[];const t=new Set;for(const n of e.explicitOrderBy)e.le.push(n),t.add(n.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new Bs(ds.comparator);return t.filters.forEach((t=>{t.getFlattenedFilters().forEach((t=>{t.isInequality()&&(e=e.add(t.field))}))})),e}(e);r.forEach((r=>{t.has(r.canonicalString())||r.isKeyField()||e.le.push(new wo(r,n))})),t.has(ds.keyField().canonicalString())||e.le.push(new wo(ds.keyField(),n))}return e.le}function Go(t){const e=zi(t);return e.he||(e.he=function(t,e){if("F"===t.limitType)return Fo(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((t=>{const e="desc"===t.dir?"asc":"desc";return new wo(t.field,e)}));const n=t.endAt?new mo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new mo(t.startAt.position,t.startAt.inclusive):null;return Fo(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}(e,Ho(t))),e.he}function zo(t,e,n){return new jo(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ko(t,e){return Uo(Go(t),Go(e))&&t.limitType===e.limitType}function qo(t){return`${Bo(Go(t))}|lt:${t.limitType}`}function Qo(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>Do(t))).join(", ")}]`),Ls(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>so(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>so(t))).join(",")),`Target(${e})`}(Go(t))}; limitType=${t.limitType})`}function Xo(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):fs.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Ho(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=yo(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,Ho(t),e)||t.endAt&&!function(t,e,n){const r=yo(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,Ho(t),e))}(t,e)}function Wo(t,e,n){const r=t.field.isKeyField()?fs.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?ro(r,i):Hi()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Hi()}}class Jo{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[e,r]of n)if(this.equalsFn(e,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],t))return void(r[n]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){Rs(this.inner,((e,n)=>{for(const[e,r]of n)t(e,r)}))}isEmpty(){return Ms(this.inner)}size(){return this.innerSize}}const Yo=new Ps(fs.comparator);function Zo(){return Yo}const ta=new Ps(fs.comparator);function ea(...t){let e=ta;for(const n of t)e=e.insert(n.key,n);return e}function na(t){let e=ta;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function ra(){return sa()}function ia(){return sa()}function sa(){return new Jo((t=>t.toString()),((t,e)=>t.isEqual(e)))}const oa=new Ps(fs.comparator),aa=new Bs(fs.comparator);function ha(...t){let e=aa;for(const n of t)e=e.add(n);return e}const la=new Bs(ss);function ua(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Os(e)?"-0":e}}function ca(t){return{integerValue:""+t}}function da(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!Os(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?ca(e):ua(t,e)}class fa{constructor(){this._=void 0}}function pa(t,e,n){return t instanceof ya?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Qs(e)&&(e=Xs(e)),e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof va?wa(t,e):t instanceof Ea?ba(t,e):function(t,e){const n=ma(t,e),r=Ta(n)+Ta(t.Ie);return ao(n)&&ao(t.Ie)?ca(r):ua(t.serializer,r)}(t,e)}function ga(t,e,n){return t instanceof va?wa(t,e):t instanceof Ea?ba(t,e):n}function ma(t,e){return t instanceof _a?function(t){return ao(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class ya extends fa{}class va extends fa{constructor(t){super(),this.elements=t}}function wa(t,e){const n=Ia(e);for(const e of t.elements)n.some((t=>eo(t,e)))||n.push(e);return{arrayValue:{values:n}}}class Ea extends fa{constructor(t){super(),this.elements=t}}function ba(t,e){let n=Ia(e);for(const e of t.elements)n=n.filter((t=>!eo(t,e)));return{arrayValue:{values:n}}}class _a extends fa{constructor(t,e){super(),this.serializer=t,this.Ie=e}}function Ta(t){return Ks(t.integerValue||t.doubleValue)}function Ia(t){return ho(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Ca{constructor(t,e){this.version=t,this.transformResults=e}}class Aa{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Aa}static exists(t){return new Aa(void 0,t)}static updateTime(t){return new Aa(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Sa(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class Da{}function Na(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Ba(t.key,Aa.none()):new Ra(t.key,t.data,Aa.none());{const n=t.data,r=fo.empty();let i=new Bs(ds.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new Ma(t.key,r,new js(i.toArray()),Aa.none())}}function ka(t,e,n){t instanceof Ra?function(t,e,n){const r=t.value.clone(),i=Va(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Ma?function(t,e,n){if(!Sa(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=Va(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Pa(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function La(t,e,n,r){return t instanceof Ra?function(t,e,n,r){if(!Sa(t.precondition,e))return n;const i=t.value.clone(),s=Fa(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ma?function(t,e,n,r){if(!Sa(t.precondition,e))return n;const i=Fa(t.fieldTransforms,r,e),s=e.data;return s.setAll(Pa(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,r):function(t,e,n){return Sa(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Oa(t,e){let n=null;for(const r of t.fieldTransforms){const t=e.data.field(r.field),i=ma(r.transform,t||null);null!=i&&(null===n&&(n=fo.empty()),n.set(r.field,i))}return n||null}function xa(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&os(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof va&&e instanceof va||t instanceof Ea&&e instanceof Ea?os(t.elements,e.elements,eo):t instanceof _a&&e instanceof _a?eo(t.Ie,e.Ie):t instanceof ya&&e instanceof ya}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ra extends Da{constructor(t,e,n,r=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ma extends Da{constructor(t,e,n,r,i=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Pa(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function Va(t,e,n){const r=new Map;Gi(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,ga(o,a,n[i]))}return r}function Fa(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,pa(t,s,e))}return r}class Ba extends Da{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ua extends Da{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ja{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let e=0;e<this.mutations.length;e++){const r=this.mutations[e];r.key.isEqual(t.key)&&ka(r,t,n[e])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=La(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=La(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=ia();return this.mutations.forEach((r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=Na(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(hs.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),ha())}isEqual(t){return this.batchId===t.batchId&&os(this.mutations,t.mutations,((t,e)=>xa(t,e)))&&os(this.baseMutations,t.baseMutations,((t,e)=>xa(t,e)))}}class $a{constructor(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}static from(t,e,n){Gi(t.mutations.length===n.length);let r=oa;const i=t.mutations;for(let t=0;t<i.length;t++)r=r.insert(i[t].key,n[t].version);return new $a(t,e,n,r)}}class Ha{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}var Ga,za;(za=Ga||(Ga={}))[za.OK=0]="OK",za[za.CANCELLED=1]="CANCELLED",za[za.UNKNOWN=2]="UNKNOWN",za[za.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",za[za.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",za[za.NOT_FOUND=5]="NOT_FOUND",za[za.ALREADY_EXISTS=6]="ALREADY_EXISTS",za[za.PERMISSION_DENIED=7]="PERMISSION_DENIED",za[za.UNAUTHENTICATED=16]="UNAUTHENTICATED",za[za.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",za[za.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",za[za.ABORTED=10]="ABORTED",za[za.OUT_OF_RANGE=11]="OUT_OF_RANGE",za[za.UNIMPLEMENTED=12]="UNIMPLEMENTED",za[za.INTERNAL=13]="INTERNAL",za[za.UNAVAILABLE=14]="UNAVAILABLE",za[za.DATA_LOSS=15]="DATA_LOSS",new xi([4294967295,4294967295],0),Error;class Ka{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function qa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Qa(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Xa(t,e){return qa(t,e.toTimestamp())}function Wa(t){return Gi(!!t),hs.fromTimestamp(function(t){const e=zs(t);return new as(e.seconds,e.nanos)}(t))}function Ja(t,e){return Ya(t,e).canonicalString()}function Ya(t,e){const n=function(t){return new us(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function Za(t,e){return Ja(t.databaseId,e.path)}function th(t){const e=function(t){const e=us.fromString(t);return Gi(function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}(e)),e}(t);return 4===e.length?us.emptyPath():function(t){return Gi(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}(e)}function eh(t,e,n){return{name:Za(t,e),fields:n.value.mapValue.fields}}function nh(t){let e=th(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Gi(1===r);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=rh(t);return e instanceof To&&Co(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map((t=>function(t){return new wo(ih(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Ls(e)?null:e}(n.limit));let h=null;n.startAt&&(h=function(t){const e=!!t.before,n=t.values||[];return new mo(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new mo(n,e)}(n.endAt)),function(t,e,n,r,i,s,o,a){return new jo(t,e,n,r,i,s,o,a)}(e,i,o,s,a,"F",h,l)}function rh(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=ih(t.unaryFilter.field);return _o.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=ih(t.unaryFilter.field);return _o.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ih(t.unaryFilter.field);return _o.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ih(t.unaryFilter.field);return _o.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Hi()}}(t):void 0!==t.fieldFilter?function(t){return _o.create(ih(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Hi()}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return To.create(t.compositeFilter.filters.map((t=>rh(t))),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return Hi()}}(t.compositeFilter.op))}(t):Hi()}function ih(t){return ds.fromServerFormat(t.fieldPath)}function sh(t){const e=[];return t.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}class oh{constructor(t){this.ct=t}}function ah(t){const e=nh({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?zo(e,e.limit,"L"):e}class hh{constructor(){}Pt(t,e){this.It(t,e),e.Tt()}It(t,e){if("nullValue"in t)this.Et(e,5);else if("booleanValue"in t)this.Et(e,10),e.dt(t.booleanValue?1:0);else if("integerValue"in t)this.Et(e,15),e.dt(Ks(t.integerValue));else if("doubleValue"in t){const n=Ks(t.doubleValue);isNaN(n)?this.Et(e,13):(this.Et(e,15),Os(n)?e.dt(0):e.dt(n))}else if("timestampValue"in t){const n=t.timestampValue;this.Et(e,20),"string"==typeof n?e.At(n):(e.At(`${n.seconds||""}`),e.dt(n.nanos||0))}else if("stringValue"in t)this.Rt(t.stringValue,e),this.Vt(e);else if("bytesValue"in t)this.Et(e,30),e.ft(qs(t.bytesValue)),this.Vt(e);else if("referenceValue"in t)this.gt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Et(e,45),e.dt(n.latitude||0),e.dt(n.longitude||0)}else"mapValue"in t?co(t)?this.Et(e,Number.MAX_SAFE_INTEGER):(this.yt(t.mapValue,e),this.Vt(e)):"arrayValue"in t?(this.wt(t.arrayValue,e),this.Vt(e)):Hi()}Rt(t,e){this.Et(e,25),this.St(t,e)}St(t,e){e.At(t)}yt(t,e){const n=t.fields||{};this.Et(e,55);for(const t of Object.keys(n))this.Rt(t,e),this.It(n[t],e)}wt(t,e){const n=t.values||[];this.Et(e,50);for(const t of n)this.It(t,e)}gt(t,e){this.Et(e,37),fs.fromName(t).path.forEach((t=>{this.Et(e,60),this.St(t,e)}))}Et(t,e){t.dt(e)}Vt(t){t.dt(2)}}hh.bt=new hh;class lh{constructor(){this._n=new uh}addToCollectionParentIndex(t,e){return this._n.add(e),Es.resolve()}getCollectionParents(t,e){return Es.resolve(this._n.getEntries(e))}addFieldIndex(t,e){return Es.resolve()}deleteFieldIndex(t,e){return Es.resolve()}deleteAllFieldIndexes(t){return Es.resolve()}createTargetIndexes(t,e){return Es.resolve()}getDocumentsMatchingTarget(t,e){return Es.resolve(null)}getIndexType(t,e){return Es.resolve(0)}getFieldIndexes(t,e){return Es.resolve([])}getNextCollectionGroupToUpdate(t){return Es.resolve(null)}getMinOffset(t,e){return Es.resolve(gs.min())}getMinOffsetFromCollectionGroup(t,e){return Es.resolve(gs.min())}updateCollectionGroup(t,e,n){return Es.resolve()}updateIndexEntries(t,e){return Es.resolve()}}class uh{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Bs(us.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new Bs(us.comparator)).toArray()}}new Uint8Array(0);class ch{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new ch(t,ch.DEFAULT_COLLECTION_PERCENTILE,ch.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ch.DEFAULT_COLLECTION_PERCENTILE=10,ch.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ch.DEFAULT=new ch(41943040,ch.DEFAULT_COLLECTION_PERCENTILE,ch.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ch.DISABLED=new ch(-1,0,0);class dh{constructor(t){this.On=t}next(){return this.On+=2,this.On}static Nn(){return new dh(0)}static Bn(){return new dh(-1)}}class fh{constructor(){this.changes=new Jo((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,go.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?Es.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class ph{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class gh{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((r=>(n=r,this.remoteDocumentCache.getEntry(t,e)))).next((t=>(null!==n&&La(n.mutation,t,js.empty(),as.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,ha()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=ha()){const r=ra();return this.populateOverlays(t,r,e).next((()=>this.computeViews(t,e,r,n).next((t=>{let e=ea();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=ra();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,ha())))}populateOverlays(t,e,n){const r=[];return n.forEach((t=>{e.has(t)||r.push(t)})),this.documentOverlayCache.getOverlays(t,r).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,r){let i=Zo();const s=sa(),o=sa();return e.forEach(((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof Ma)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),La(o.mutation,e,o.mutation.getFieldMask(),as.now())):s.set(e.key,js.empty())})),this.recalculateAndSaveOverlays(t,i).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new ph(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=sa();let r=new Ps(((t,e)=>t-e)),i=ha();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const i of t)i.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||js.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||ha()).add(t);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,h=r.value,l=ia();h.forEach((t=>{if(!i.has(t)){const r=Na(e.get(t),n.get(t));null!==r&&l.set(t,r),i=i.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return Es.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return fs.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):function(t){return null!==t.collectionGroup}(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):Es.resolve(ra());let o=-1,a=i;return s.next((e=>Es.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?Es.resolve():this.remoteDocumentCache.getEntry(t,e).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,i))).next((()=>this.computeViews(t,a,e,ha()))).next((t=>({batchId:o,changes:na(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new fs(e)).next((t=>{let e=ea();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=ea();return this.indexManager.getCollectionParents(t,i).next((o=>Es.forEach(o,(o=>{const a=function(t,e){return new jo(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next((t=>{t.forEach(((t,e)=>{s=s.insert(t,e)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r)))).next((t=>{i.forEach(((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,go.newInvalidDocument(r)))}));let n=ea();return t.forEach(((t,r)=>{const s=i.get(t);void 0!==s&&La(s.mutation,r,js.empty(),as.now()),Xo(e,r)&&(n=n.insert(t,r))})),n}))}}class mh{constructor(t){this.serializer=t,this.cr=new Map,this.lr=new Map}getBundleMetadata(t,e){return Es.resolve(this.cr.get(e))}saveBundleMetadata(t,e){return this.cr.set(e.id,function(t){return{id:t.id,version:t.version,createTime:Wa(t.createTime)}}(e)),Es.resolve()}getNamedQuery(t,e){return Es.resolve(this.lr.get(e))}saveNamedQuery(t,e){return this.lr.set(e.name,function(t){return{name:t.name,query:ah(t.bundledQuery),readTime:Wa(t.readTime)}}(e)),Es.resolve()}}class yh{constructor(){this.overlays=new Ps(fs.comparator),this.hr=new Map}getOverlay(t,e){return Es.resolve(this.overlays.get(e))}getOverlays(t,e){const n=ra();return Es.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,r)=>{this.ht(t,e,r)})),Es.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((t=>this.overlays=this.overlays.remove(t))),this.hr.delete(n)),Es.resolve()}getOverlaysForCollection(t,e,n){const r=ra(),i=e.length+1,s=new fs(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return Es.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new Ps(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=ra(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=ra(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=r)););return Es.resolve(o)}ht(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Ha(e,n));let i=this.hr.get(e);void 0===i&&(i=ha(),this.hr.set(e,i)),this.hr.set(e,i.add(n.key))}}class vh{constructor(){this.Pr=new Bs(wh.Ir),this.Tr=new Bs(wh.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(t,e){const n=new wh(t,e);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.Ar(new wh(t,e))}Rr(t,e){t.forEach((t=>this.removeReference(t,e)))}Vr(t){const e=new fs(new us([])),n=new wh(e,t),r=new wh(e,t+1),i=[];return this.Tr.forEachInRange([n,r],(t=>{this.Ar(t),i.push(t.key)})),i}mr(){this.Pr.forEach((t=>this.Ar(t)))}Ar(t){this.Pr=this.Pr.delete(t),this.Tr=this.Tr.delete(t)}gr(t){const e=new fs(new us([])),n=new wh(e,t),r=new wh(e,t+1);let i=ha();return this.Tr.forEachInRange([n,r],(t=>{i=i.add(t.key)})),i}containsKey(t){const e=new wh(t,0),n=this.Pr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class wh{constructor(t,e){this.key=t,this.pr=e}static Ir(t,e){return fs.comparator(t.key,e.key)||ss(t.pr,e.pr)}static Er(t,e){return ss(t.pr,e.pr)||fs.comparator(t.key,e.key)}}class Eh{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.yr=1,this.wr=new Bs(wh.Ir)}checkEmpty(t){return Es.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ja(i,e,n,r);this.mutationQueue.push(s);for(const e of r)this.wr=this.wr.add(new wh(e.key,i)),this.indexManager.addToCollectionParentIndex(t,e.key.path.popLast());return Es.resolve(s)}lookupMutationBatch(t,e){return Es.resolve(this.Sr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.br(n),i=r<0?0:r;return Es.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Es.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(t){return Es.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new wh(e,0),r=new wh(e,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(t=>{const e=this.Sr(t.pr);i.push(e)})),Es.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new Bs(ss);return e.forEach((t=>{const e=new wh(t,0),r=new wh(t,Number.POSITIVE_INFINITY);this.wr.forEachInRange([e,r],(t=>{n=n.add(t.pr)}))})),Es.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;fs.isDocumentKey(i)||(i=i.child(""));const s=new wh(new fs(i),0);let o=new Bs(ss);return this.wr.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.pr)),!0)}),s),Es.resolve(this.Dr(o))}Dr(t){const e=[];return t.forEach((t=>{const n=this.Sr(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Gi(0===this.Cr(e.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return Es.forEach(e.mutations,(r=>{const i=new wh(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)})).next((()=>{this.wr=n}))}Mn(t){}containsKey(t,e){const n=new wh(e,0),r=this.wr.firstAfterOrEqual(n);return Es.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,Es.resolve()}Cr(t,e){return this.br(t)}br(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Sr(t){const e=this.br(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class bh{constructor(t){this.vr=t,this.docs=new Ps(fs.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.vr(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return Es.resolve(n?n.document.mutableCopy():go.newInvalidDocument(e))}getEntries(t,e){let n=Zo();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():go.newInvalidDocument(t))})),Es.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=Zo();const s=e.path,o=new fs(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||ms(ps(o),n)<=0||(r.has(o.key)||Xo(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Es.resolve(i)}getAllFromCollectionGroup(t,e,n,r){Hi()}Fr(t,e){return Es.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new _h(this)}getSize(t){return Es.resolve(this.size)}}class _h extends fh{constructor(t){super(),this.ar=t}applyChanges(t){const e=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?e.push(this.ar.addEntry(t,r)):this.ar.removeEntry(n)})),Es.waitFor(e)}getFromCache(t,e){return this.ar.getEntry(t,e)}getAllFromCache(t,e){return this.ar.getEntries(t,e)}}class Th{constructor(t){this.persistence=t,this.Mr=new Jo((t=>Bo(t)),Uo),this.lastRemoteSnapshotVersion=hs.min(),this.highestTargetId=0,this.Or=0,this.Nr=new vh,this.targetCount=0,this.Br=dh.Nn()}forEachTarget(t,e){return this.Mr.forEach(((t,n)=>e(n))),Es.resolve()}getLastRemoteSnapshotVersion(t){return Es.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Es.resolve(this.Or)}allocateTargetId(t){return this.highestTargetId=this.Br.next(),Es.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Or&&(this.Or=e),Es.resolve()}qn(t){this.Mr.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Br=new dh(e),this.highestTargetId=e),t.sequenceNumber>this.Or&&(this.Or=t.sequenceNumber)}addTargetData(t,e){return this.qn(e),this.targetCount+=1,Es.resolve()}updateTargetData(t,e){return this.qn(e),Es.resolve()}removeTargetData(t,e){return this.Mr.delete(e.target),this.Nr.Vr(e.targetId),this.targetCount-=1,Es.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.Mr.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Mr.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)})),Es.waitFor(i).next((()=>r))}getTargetCount(t){return Es.resolve(this.targetCount)}getTargetData(t,e){const n=this.Mr.get(e)||null;return Es.resolve(n)}addMatchingKeys(t,e,n){return this.Nr.dr(e,n),Es.resolve()}removeMatchingKeys(t,e,n){this.Nr.Rr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((e=>{i.push(r.markPotentiallyOrphaned(t,e))})),Es.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.Nr.Vr(e),Es.resolve()}getMatchingKeysForTargetId(t,e){const n=this.Nr.gr(e);return Es.resolve(n)}containsKey(t,e){return Es.resolve(this.Nr.containsKey(e))}}class Ih{constructor(t,e){this.Lr={},this.overlays={},this.kr=new ks(0),this.qr=!1,this.qr=!0,this.referenceDelegate=t(this),this.Qr=new Th(this),this.indexManager=new lh,this.remoteDocumentCache=function(t){return new bh(t)}((t=>this.referenceDelegate.Kr(t))),this.serializer=new oh(e),this.$r=new mh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new yh,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.Lr[t.toKey()];return n||(n=new Eh(e,this.referenceDelegate),this.Lr[t.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(t,e,n){Bi("MemoryPersistence","Starting transaction:",t);const r=new Ch(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((t=>this.referenceDelegate.Wr(r).next((()=>t)))).toPromise().then((t=>(r.raiseOnCommittedEvent(),t)))}Gr(t,e){return Es.or(Object.values(this.Lr).map((n=>()=>n.containsKey(t,e))))}}class Ch extends vs{constructor(t){super(),this.currentSequenceNumber=t}}class Ah{constructor(t){this.persistence=t,this.zr=new vh,this.jr=null}static Hr(t){return new Ah(t)}get Jr(){if(this.jr)return this.jr;throw Hi()}addReference(t,e,n){return this.zr.addReference(n,e),this.Jr.delete(n.toString()),Es.resolve()}removeReference(t,e,n){return this.zr.removeReference(n,e),this.Jr.add(n.toString()),Es.resolve()}markPotentiallyOrphaned(t,e){return this.Jr.add(e.toString()),Es.resolve()}removeTarget(t,e){this.zr.Vr(e.targetId).forEach((t=>this.Jr.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Jr.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Ur(){this.jr=new Set}Wr(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Es.forEach(this.Jr,(n=>{const r=fs.fromPath(n);return this.Yr(t,r).next((t=>{t||e.removeEntry(r,hs.min())}))})).next((()=>(this.jr=null,e.apply(t))))}updateLimboDocument(t,e){return this.Yr(t,e).next((t=>{t?this.Jr.delete(e.toString()):this.Jr.add(e.toString())}))}Kr(t){return 0}Yr(t,e){return Es.or([()=>Es.resolve(this.zr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Gr(t,e)])}}class Sh{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.qi=n,this.Qi=r}static Ki(t,e){let n=ha(),r=ha();for(const t of e.docChanges)switch(t.type){case 0:n=n.add(t.doc.key);break;case 1:r=r.add(t.doc.key)}return new Sh(t,e.fromCache,n,r)}}class Dh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class Nh{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){var t;const e=null===(t=s())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}()||!navigator.userAgent.includes("Safari")||navigator.userAgent.includes("Chrome")?_s.v(l())>0?6:4:8}initialize(t,e){this.zi=t,this.indexManager=e,this.$i=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.ji(t,e).next((t=>{i.result=t})).next((()=>{if(!i.result)return this.Hi(t,e,r,n).next((t=>{i.result=t}))})).next((()=>{if(i.result)return;const n=new Dh;return this.Ji(t,e,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(t,e,n,r.size)}))})).next((()=>i.result))}Yi(t,e,n,r){return n.documentReadCount<this.Wi?(Fi()<=_.DEBUG&&Bi("QueryEngine","SDK will not create cache indexes for query:",Qo(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Es.resolve()):(Fi()<=_.DEBUG&&Bi("QueryEngine","Query:",Qo(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(Fi()<=_.DEBUG&&Bi("QueryEngine","The SDK decides to create cache indexes for query:",Qo(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Go(e))):Es.resolve())}ji(t,e){if($o(e))return Es.resolve(null);let n=Go(e);return this.indexManager.getIndexType(t,n).next((r=>0===r?null:(null!==e.limit&&1===r&&(e=zo(e,null,"F"),n=Go(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next((r=>{const i=ha(...r);return this.zi.getDocuments(t,i).next((r=>this.indexManager.getMinOffset(t,n).next((n=>{const s=this.Zi(e,r);return this.Xi(e,s,i,n.readTime)?this.ji(t,zo(e,null,"F")):this.es(t,s,e,n)}))))})))))}Hi(t,e,n,r){return $o(e)||r.isEqual(hs.min())?Es.resolve(null):this.zi.getDocuments(t,n).next((i=>{const s=this.Zi(e,i);return this.Xi(e,s,n,r)?Es.resolve(null):(Fi()<=_.DEBUG&&Bi("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Qo(e)),this.es(t,s,e,function(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=hs.fromTimestamp(1e9===r?new as(n+1,0):new as(n,r));return new gs(i,fs.empty(),e)}(r,-1)).next((t=>t)))}))}Zi(t,e){let n=new Bs(function(t){return(e,n)=>{let r=!1;for(const i of Ho(t)){const t=Wo(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}(t));return e.forEach(((e,r)=>{Xo(t,r)&&(n=n.add(r))})),n}Xi(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(t,e,n){return Fi()<=_.DEBUG&&Bi("QueryEngine","Using full collection scan to execute query:",Qo(e)),this.zi.getDocumentsMatchingQuery(t,e,gs.min(),n)}es(t,e,n,r){return this.zi.getDocumentsMatchingQuery(t,n,r).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class kh{constructor(t,e,n,r){this.persistence=t,this.ts=e,this.serializer=r,this.ns=new Ps(ss),this.rs=new Jo((t=>Bo(t)),Uo),this.ss=new Map,this.os=t.getRemoteDocumentCache(),this.Qr=t.getTargetCache(),this.$r=t.getBundleCache(),this._s(n)}_s(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new gh(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.ns)))}}async function Lh(t,e){const n=zi(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next((i=>(r=i,n._s(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const i=[],s=[];let o=ha();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({us:t,removedBatchIds:i,addedBatchIds:s})))}))}))}function Oh(t,e){const n=zi(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(t=>(void 0===e&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(t,e))))}class xh{constructor(){this.activeTargetIds=la}As(t){this.activeTargetIds=this.activeTargetIds.add(t)}Rs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}ds(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Rh{constructor(){this.no=new xh,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.no.As(t),this.ro[t]||"not-current"}updateQueryState(t,e,n){this.ro[t]=e}removeLocalQueryTarget(t){this.no.Rs(t)}isLocalQueryTarget(t){return this.no.activeTargetIds.has(t)}clearQueryState(t){delete this.ro[t]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(t){return this.no.activeTargetIds.has(t)}start(){return this.no=new xh,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Mh{io(t){}shutdown(){}}class Ph{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(t){this.uo.push(t)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Bi("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.uo)t(0)}ao(){Bi("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.uo)t(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Vh=null;function Fh(){return null===Vh?Vh=268435456+Math.round(2147483648*Math.random()):Vh++,"0x"+Vh.toString(16)}const Bh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Uh{constructor(t){this.lo=t.lo,this.ho=t.ho}Po(t){this.Io=t}To(t){this.Eo=t}onMessage(t){this.Ao=t}close(){this.ho()}send(t){this.lo(t)}Ro(){this.Io()}Vo(t){this.Eo(t)}mo(t){this.Ao(t)}}const jh="WebChannelConnection";class $h extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=e+"://"+t.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(t,e,n,r,i){const s=Fh(),o=this.bo(t,e.toUriEncodedString());Bi("RestConnection",`Sending RPC '${t}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(t,o,a,n).then((e=>(Bi("RestConnection",`Received RPC '${t}' ${s}: `,e),e)),(e=>{throw ji("RestConnection",`RPC '${t}' ${s} failed with error: `,e,"url: ",o,"request:",n),e}))}vo(t,e,n,r,i,s){return this.So(t,e,n,r,i)}Do(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+Pi,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}bo(t,e){const n=Bh[t];return`${this.fo}/v1/${e}:${n}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Co(t,e,n,r){const i=Fh();return new Promise(((s,o)=>{const a=new Oi;a.setWithCredentials(!0),a.listenOnce(Di.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Si.NO_ERROR:const e=a.getResponseJson();Bi(jh,`XHR for RPC '${t}' ${i} received:`,JSON.stringify(e)),s(e);break;case Si.TIMEOUT:Bi(jh,`RPC '${t}' ${i} timed out`),o(new qi(Ki.DEADLINE_EXCEEDED,"Request time out"));break;case Si.HTTP_ERROR:const n=a.getStatus();if(Bi(jh,`RPC '${t}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ki).indexOf(e)>=0?e:Ki.UNKNOWN}(e.status);o(new qi(t,e.message))}else o(new qi(Ki.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new qi(Ki.UNAVAILABLE,"Connection failed."));break;default:Hi()}}finally{Bi(jh,`RPC '${t}' ${i} completed.`)}}));const h=JSON.stringify(r);Bi(jh,`RPC '${t}' ${i} sending request:`,r),a.send(e,"POST",h,n,15)}))}Fo(t,e,n){const r=Fh(),i=[this.fo,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=Ci(),o=Ai(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;void 0!==h&&(a.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=i.join("");Bi(jh,`Creating RPC '${t}' stream ${r}: ${l}`,a);const u=s.createWebChannel(l,a);let c=!1,d=!1;const f=new Uh({lo:e=>{d?Bi(jh,`Not sending because RPC '${t}' stream ${r} is closed:`,e):(c||(Bi(jh,`Opening RPC '${t}' stream ${r} transport.`),u.open(),c=!0),Bi(jh,`RPC '${t}' stream ${r} sending:`,e),u.send(e))},ho:()=>u.close()}),p=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return p(u,Li.EventType.OPEN,(()=>{d||Bi(jh,`RPC '${t}' stream ${r} transport opened.`)})),p(u,Li.EventType.CLOSE,(()=>{d||(d=!0,Bi(jh,`RPC '${t}' stream ${r} transport closed`),f.Vo())})),p(u,Li.EventType.ERROR,(e=>{d||(d=!0,ji(jh,`RPC '${t}' stream ${r} transport errored:`,e),f.Vo(new qi(Ki.UNAVAILABLE,"The operation could not be completed")))})),p(u,Li.EventType.MESSAGE,(e=>{var n;if(!d){const i=e.data[0];Gi(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Bi(jh,`RPC '${t}' stream ${r} received error:`,o);const e=o.status;let n=function(t){const e=Ga[t];if(void 0!==e)return function(t){if(void 0===t)return Ui("GRPC error has no .code"),Ki.UNKNOWN;switch(t){case Ga.OK:return Ki.OK;case Ga.CANCELLED:return Ki.CANCELLED;case Ga.UNKNOWN:return Ki.UNKNOWN;case Ga.DEADLINE_EXCEEDED:return Ki.DEADLINE_EXCEEDED;case Ga.RESOURCE_EXHAUSTED:return Ki.RESOURCE_EXHAUSTED;case Ga.INTERNAL:return Ki.INTERNAL;case Ga.UNAVAILABLE:return Ki.UNAVAILABLE;case Ga.UNAUTHENTICATED:return Ki.UNAUTHENTICATED;case Ga.INVALID_ARGUMENT:return Ki.INVALID_ARGUMENT;case Ga.NOT_FOUND:return Ki.NOT_FOUND;case Ga.ALREADY_EXISTS:return Ki.ALREADY_EXISTS;case Ga.PERMISSION_DENIED:return Ki.PERMISSION_DENIED;case Ga.FAILED_PRECONDITION:return Ki.FAILED_PRECONDITION;case Ga.ABORTED:return Ki.ABORTED;case Ga.OUT_OF_RANGE:return Ki.OUT_OF_RANGE;case Ga.UNIMPLEMENTED:return Ki.UNIMPLEMENTED;case Ga.DATA_LOSS:return Ki.DATA_LOSS;default:return Hi()}}(e)}(e),i=o.message;void 0===n&&(n=Ki.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),d=!0,f.Vo(new qi(n,i)),u.close()}else Bi(jh,`RPC '${t}' stream ${r} received:`,i),f.mo(i)}})),p(o,Ni.STAT_EVENT,(e=>{e.stat===ki.PROXY?Bi(jh,`RPC '${t}' stream ${r} detected buffering proxy`):e.stat===ki.NOPROXY&&Bi(jh,`RPC '${t}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.Ro()}),0),f}}function Hh(){return"undefined"!=typeof document?document:null}function Gh(t){return new Ka(t,!0)}class zh{constructor(t,e,n=1e3,r=1.5,i=6e4){this.oi=t,this.timerId=e,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(t){this.cancel();const e=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),r=Math.max(0,e-n);r>0&&Bi("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Lo=Date.now(),t()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class Kh{constructor(t,e,n,r,i,s,o,a){this.oi=t,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new zh(t,e)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(t){this.n_(),this.stream.send(t)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(t,e){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==t?this.jo.reset():e&&e.code===Ki.RESOURCE_EXHAUSTED?(Ui(e.toString()),Ui("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):e&&e.code===Ki.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.To(e)}i_(){}auth(){this.state=1;const t=this.s_(this.Wo),e=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Wo===e&&this.o_(t,n)}),(e=>{t((()=>{const t=new qi(Ki.UNKNOWN,"Fetching auth token failed: "+e.message);return this.__(t)}))}))}o_(t,e){const n=this.s_(this.Wo);this.stream=this.a_(t,e),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((t=>{n((()=>this.__(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(t){return Bi("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}s_(t){return e=>{this.oi.enqueueAndForget((()=>this.Wo===t?e():(Bi("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qh extends Kh{constructor(t,e,n,r,i,s){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,n,r,s),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(t,e){return this.connection.Fo("Write",t,e)}onMessage(t){if(Gi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.h_){this.jo.reset();const e=function(t,e){return t&&t.length>0?(Gi(void 0!==e),t.map((t=>function(t,e){let n=t.updateTime?Wa(t.updateTime):Wa(e);return n.isEqual(hs.min())&&(n=Wa(e)),new Ca(n,t.transformResults||[])}(t,e)))):[]}(t.writeResults,t.commitTime),n=Wa(t.commitTime);return this.listener.T_(n,e)}return Gi(!t.writeResults||0===t.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const t={};t.database=function(t){return new us(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}(this.serializer),this.t_(t)}I_(t){const e={streamToken:this.lastStreamToken,writes:t.map((t=>function(t,e){let n;if(e instanceof Ra)n={update:eh(t,e.key,e.value)};else if(e instanceof Ba)n={delete:Za(t,e.key)};else if(e instanceof Ma)n={update:eh(t,e.key,e.data),updateMask:sh(e.fieldMask)};else{if(!(e instanceof Ua))return Hi();n={verify:Za(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((t=>function(t,e){const n=e.transform;if(n instanceof ya)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof va)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ea)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof _a)return{fieldPath:e.field.canonicalString(),increment:n.Ie};throw Hi()}(0,t)))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Xa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Hi()}(t,e.precondition)),n}(this.serializer,t)))};this.t_(e)}}class Qh extends class{}{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new qi(Ki.FAILED_PRECONDITION,"The client has already been terminated.")}So(t,e,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.So(t,Ya(e,n),r,i,s))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ki.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new qi(Ki.UNKNOWN,t.toString())}))}vo(t,e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.vo(t,Ya(e,n),r,s,o,i))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Ki.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new qi(Ki.UNKNOWN,t.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class Xh{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(t){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.y_("Offline")))}set(t){this.b_(),this.m_=0,"Online"===t&&(this.g_=!1),this.y_(t)}y_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}w_(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ui(e),this.g_=!1):Bi("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Wh{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((t=>{n.enqueueAndForget((async()=>{Zh(this)&&(Bi("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=zi(t);e.v_.add(4),await Yh(e),e.x_.set("Unknown"),e.v_.delete(4),await Jh(e)}(this))}))})),this.x_=new Xh(n,r)}}async function Jh(t){if(Zh(t))for(const e of t.F_)await e(!0)}async function Yh(t){for(const e of t.F_)await e(!1)}function Zh(t){return 0===zi(t).v_.size}async function tl(t,e,n){if(!Cs(e))throw e;t.v_.add(1),await Yh(t),t.x_.set("Offline"),n||(n=()=>function(t){const e=zi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Qr.getLastRemoteSnapshotVersion(t)))}(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Bi("RemoteStore","Retrying IndexedDB access"),await n(),t.v_.delete(1),await Jh(t)}))}function el(t,e){return e().catch((n=>tl(t,n,e)))}async function nl(t){const e=zi(t),n=dl(e);let r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;rl(e);)try{const t=await Oh(e.localStore,r);if(null===t){0===e.D_.length&&n.Xo();break}r=t.batchId,il(e,t)}catch(t){await tl(e,t)}sl(e)&&ol(e)}function rl(t){return Zh(t)&&t.D_.length<10}function il(t,e){t.D_.push(e);const n=dl(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function sl(t){return Zh(t)&&!dl(t).Ho()&&t.D_.length>0}function ol(t){dl(t).start()}async function al(t){dl(t).d_()}async function hl(t){const e=dl(t);for(const n of t.D_)e.I_(n.mutations)}async function ll(t,e,n){const r=t.D_.shift(),i=$a.from(r,e,n);await el(t,(()=>t.remoteSyncer.applySuccessfulWrite(i))),await nl(t)}async function ul(t,e){e&&dl(t).P_&&await async function(t,e){if(function(t){return function(t){switch(t){default:return Hi();case Ki.CANCELLED:case Ki.UNKNOWN:case Ki.DEADLINE_EXCEEDED:case Ki.RESOURCE_EXHAUSTED:case Ki.INTERNAL:case Ki.UNAVAILABLE:case Ki.UNAUTHENTICATED:return!1;case Ki.INVALID_ARGUMENT:case Ki.NOT_FOUND:case Ki.ALREADY_EXISTS:case Ki.PERMISSION_DENIED:case Ki.FAILED_PRECONDITION:case Ki.ABORTED:case Ki.OUT_OF_RANGE:case Ki.UNIMPLEMENTED:case Ki.DATA_LOSS:return!0}}(t)&&t!==Ki.ABORTED}(e.code)){const n=t.D_.shift();dl(t).Zo(),await el(t,(()=>t.remoteSyncer.rejectFailedWrite(n.batchId,e))),await nl(t)}}(t,e),sl(t)&&ol(t)}async function cl(t,e){const n=zi(t);n.asyncQueue.verifyOperationInProgress(),Bi("RemoteStore","RemoteStore received new credentials");const r=Zh(n);n.v_.add(3),await Yh(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),await Jh(n)}function dl(t){return t.B_||(t.B_=function(t,e,n){const r=zi(t);return r.R_(),new qh(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Po:al.bind(null,t),To:ul.bind(null,t),E_:hl.bind(null,t),T_:ll.bind(null,t)}),t.F_.push((async e=>{e?(t.B_.Zo(),await nl(t)):(await t.B_.stop(),t.D_.length>0&&(Bi("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}class fl{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Qi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new fl(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new qi(Ki.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pl(t,e){if(Ui("AsyncQueue",`${e}: ${t}`),Cs(t))return new qi(Ki.UNAVAILABLE,`${e}: ${t}`);throw t}class gl{constructor(){this.queries=new Jo((t=>qo(t)),Ko),this.onlineState="Unknown",this.K_=new Set}}class ml{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.fa={},this.ga=new Jo((t=>qo(t)),Ko),this.pa=new Map,this.ya=new Set,this.wa=new Ps(fs.comparator),this.Sa=new Map,this.ba=new vh,this.Da={},this.Ca=new Map,this.va=dh.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}function yl(t,e,n){const r=zi(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.ga.forEach(((n,r)=>{const i=r.view.U_(e);i.snapshot&&t.push(i.snapshot)})),function(t,e){const n=zi(t);n.onlineState=e;let r=!1;n.queries.forEach(((t,n)=>{for(const t of n.Q_)t.U_(e)&&(r=!0)})),r&&function(t){t.K_.forEach((t=>{t.next()}))}(n)}(r.eventManager,e),t.length&&r.fa.u_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function vl(t,e){const n=zi(t),r=e.batch.batchId;try{const t=await function(t,e){const n=zi(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(t=>{const r=e.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){const i=n.batch,s=i.keys();let o=Es.resolve();return s.forEach((t=>{o=o.next((()=>r.getEntry(e,t))).next((e=>{const s=n.docVersions.get(t);Gi(null!==s),e.version.compareTo(s)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&(e.setReadTime(n.commitVersion),r.addEntry(e)))}))})),o.next((()=>t.mutationQueue.removeMutationBatch(e,i)))}(n,t,e,i).next((()=>i.apply(t))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,function(t){let e=ha();for(let n=0;n<t.mutationResults.length;++n)t.mutationResults[n].transformResults.length>0&&(e=e.add(t.batch.mutations[n].key));return e}(e)))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(n.localStore,e);bl(n,r,null),El(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await _l(n,t)}catch(t){await ws(t)}}async function wl(t,e,n){const r=zi(t);try{const t=await function(t,e){const n=zi(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(t=>{let r;return n.mutationQueue.lookupMutationBatch(t,e).next((e=>(Gi(null!==e),r=e.keys(),n.mutationQueue.removeMutationBatch(t,e)))).next((()=>n.mutationQueue.performConsistencyCheck(t))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(t,r,e))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(t,r))).next((()=>n.localDocuments.getDocuments(t,r)))}))}(r.localStore,e);bl(r,e,n),El(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await _l(r,t)}catch(n){await ws(n)}}function El(t,e){(t.Ca.get(e)||[]).forEach((t=>{t.resolve()})),t.Ca.delete(e)}function bl(t,e,n){const r=zi(t);let i=r.Da[r.currentUser.toKey()];if(i){const t=i.get(e);t&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}async function _l(t,e,n){const r=zi(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach(((t,a)=>{o.push(r.Ma(a,e,n).then((t=>{if((t||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){i.push(t);const e=Sh.Ki(a.targetId,t);s.push(e)}})))})),await Promise.all(o),r.fa.u_(i),await async function(t,e){const n=zi(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>Es.forEach(e,(e=>Es.forEach(e.qi,(r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r))).next((()=>Es.forEach(e.Qi,(r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))))))}catch(t){if(!Cs(t))throw t;Bi("LocalStore","Failed to update sequence numbers: "+t)}for(const t of e){const e=t.targetId;if(!t.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,i)}}}(r.localStore,s))}async function Tl(t,e){const n=zi(t);if(!n.currentUser.isEqual(e)){Bi("SyncEngine","User change. New user:",e.toKey());const t=await Lh(n.localStore,e);n.currentUser=e,function(t,e){t.Ca.forEach((t=>{t.forEach((t=>{t.reject(new qi(Ki.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Ca.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await _l(n,t.us)}}function Il(t){const e=zi(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wl.bind(null,e),e}class Cl{constructor(){this.synchronizeTabs=!1}async initialize(t){this.serializer=Gh(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),await this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return function(t,e,n,r){return new kh(t,e,n,r)}(this.persistence,new Nh,t.initialUser,this.serializer)}createPersistence(t){return new Ih(Ah.Hr,this.serializer)}createSharedClientState(t){return new Rh}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Al{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>yl(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Tl.bind(null,this.syncEngine),await async function(t,e){const n=zi(t);e?(n.v_.delete(2),await Jh(n)):e||(n.v_.add(2),await Yh(n),n.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new gl}createDatastore(t){const e=Gh(t.databaseInfo.databaseId),n=function(t){return new $h(t)}(t.databaseInfo);return function(t,e,n,r){return new Qh(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new Wh(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,(t=>yl(this.syncEngine,t,0)),Ph.D()?new Ph:new Mh)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new ml(t,e,n,r,i,s);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t;await async function(t){const e=zi(t);Bi("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await Yh(e),e.M_.shutdown(),e.x_.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate()}}class Sl{constructor(t,e,n,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=Mi.UNAUTHENTICATED,this.clientId=is.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Bi("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Bi("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new qi(Ki.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Qi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=pl(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Dl(t,e){t.asyncQueue.verifyOperationInProgress(),Bi("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async t=>{r.isEqual(t)||(await Lh(e.localStore,t),r=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Nl(t,e){t.asyncQueue.verifyOperationInProgress();const n=await async function(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Bi("FirestoreClient","Using user provided OfflineComponentProvider");try{await Dl(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===Ki.FAILED_PRECONDITION||t.code===Ki.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;ji("Error using user provided cache. Falling back to memory cache: "+n),await Dl(t,new Cl)}}else Bi("FirestoreClient","Using default OfflineComponentProvider"),await Dl(t,new Cl);return t._offlineComponents}(t);Bi("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((t=>cl(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>cl(e.remoteStore,n))),t._onlineComponents=e}function kl(t){return async function(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Bi("FirestoreClient","Using user provided OnlineComponentProvider"),await Nl(t,t._uninitializedComponentsProvider._online)):(Bi("FirestoreClient","Using default OnlineComponentProvider"),await Nl(t,new Al))),t._onlineComponents}(t).then((t=>t.syncEngine))}function Ll(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const Ol=new Map;function xl(t,e,n){if(!n)throw new qi(Ki.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Rl(t){if(!fs.isDocumentKey(t))throw new qi(Ki.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ml(t){if(fs.isDocumentKey(t))throw new qi(Ki.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Pl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Hi()}function Vl(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new qi(Ki.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Pl(t);throw new qi(Ki.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Fl{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new qi(Ki.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new qi(Ki.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new qi(Ki.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ll(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new qi(Ki.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new qi(Ki.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(t.timeoutSeconds>30)throw new qi(Ki.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Bl{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new qi(Ki.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new qi(Ki.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fl(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Wi;switch(t.type){case"firstParty":return new ts(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new qi(Ki.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Ol.get(t);e&&(Bi("ComponentProvider","Removing Datastore"),Ol.delete(t),e.terminate())}(this),Promise.resolve()}}class Ul{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new Ul(this.firestore,t,this._query)}}class jl{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $l(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new jl(this.firestore,t,this._key)}}class $l extends Ul{constructor(t,e,n){super(t,e,function(t){return new jo(t)}(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new jl(this.firestore,null,new fs(t))}withConverter(t){return new $l(this.firestore,t,this._path)}}class Hl{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new zh(this,"async_queue_retry"),this._u=()=>{const t=Hh();t&&Bi("AsyncQueue","Visibility state changed to "+t.visibilityState),this.jo.Ko()};const t=Hh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.au(),this.uu(t)}enterRestrictedMode(t){if(!this.tu){this.tu=!0,this.su=t||!1;const e=Hh();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this._u)}}enqueue(t){if(this.au(),this.tu)return new Promise((()=>{}));const e=new Qi;return this.uu((()=>this.tu&&this.su?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.eu.push(t),this.cu())))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(t){if(!Cs(t))throw t;Bi("AsyncQueue","Operation failed with retryable error: "+t)}this.eu.length>0&&this.jo.qo((()=>this.cu()))}}uu(t){const e=this.Xa.then((()=>(this.iu=!0,t().catch((t=>{this.ru=t,this.iu=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Ui("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.iu=!1,t))))));return this.Xa=e,e}enqueueAfterDelay(t,e,n){this.au(),this.ou.indexOf(t)>-1&&(e=0);const r=fl.createAndSchedule(this,t,e,n,(t=>this.lu(t)));return this.nu.push(r),r}au(){this.ru&&Hi()}verifyOperationInProgress(){}async hu(){let t;do{t=this.Xa,await t}while(t!==this.Xa)}Pu(t){for(const e of this.nu)if(e.timerId===t)return!0;return!1}Iu(t){return this.hu().then((()=>{this.nu.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.nu)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.hu()}))}Tu(t){this.ou.push(t)}lu(t){const e=this.nu.indexOf(t);this.nu.splice(e,1)}}class Gl extends Bl{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new Hl,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Kl(this),this._firestoreClient.terminate()}}function zl(t,e){const n="object"==typeof t?t:function(t=X){const e=J.get(t);if(!e&&t===X&&a())return rt();if(!e)throw et.create("no-app",{appName:t});return e}(),r="string"==typeof t?t:e||"(default)",s=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const t=o("firestore");t&&function(t,e,n,r={}){var s;const o=(t=Vl(t,Bl))._getSettings(),a=`${e}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&ji("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:a,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=Mi.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[i(JSON.stringify({alg:"none",type:"JWT"})),i(JSON.stringify(o)),""].join(".")}(r.mockUserToken,null===(s=t._app)||void 0===s?void 0:s.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new qi(Ki.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Mi(o)}t._authCredentials=new Ji(new Xi(e,n))}}(s,...t)}return s}function Kl(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new Js(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ll(r.experimentalLongPollingOptions),r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new Sl(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class ql{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ql(Hs.fromBase64String(t))}catch(t){throw new qi(Ki.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new ql(Hs.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Ql{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new qi(Ki.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ds(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Xl{constructor(t){this._methodName=t}}class Wl{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new qi(Ki.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new qi(Ki.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return ss(this._lat,t._lat)||ss(this._long,t._long)}}const Jl=/^__.*__$/;class Yl{constructor(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}toMutation(t,e){return null!==this.fieldMask?new Ma(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ra(t,this.data,e,this.fieldTransforms)}}function Zl(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Hi()}}class tu{constructor(t,e,n,r,i,s){this.settings=t,this.databaseId=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Eu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(t){return new tu(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Au({path:n,Vu:!1});return r.mu(t),r}fu(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Au({path:n,Vu:!1});return r.Eu(),r}gu(t){return this.Au({path:void 0,Vu:!0})}pu(t){return uu(t,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(t){return void 0!==this.fieldMask.find((e=>t.isPrefixOf(e)))||void 0!==this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))}Eu(){if(this.path)for(let t=0;t<this.path.length;t++)this.mu(this.path.get(t))}mu(t){if(0===t.length)throw this.pu("Document fields must not be empty");if(Zl(this.du)&&Jl.test(t))throw this.pu('Document fields cannot begin and end with "__"')}}class eu{constructor(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=n||Gh(t)}Su(t,e,n,r=!1){return new tu({du:t,methodName:e,wu:n,path:ds.emptyPath(),Vu:!1,yu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nu(t){const e=t._freezeSettings(),n=Gh(t._databaseId);return new eu(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ru(t,e,n,r,i,s={}){const o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);au("Data must be an object, but it was:",o,r);const a=su(r,o);let h,l;if(s.merge)h=new js(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){const t=[];for(const r of s.mergeFields){const i=hu(e,r,n);if(!o.contains(i))throw new qi(Ki.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);cu(t,i)||t.push(i)}h=new js(t),l=o.fieldTransforms.filter((t=>h.covers(t.field)))}else h=null,l=o.fieldTransforms;return new Yl(new fo(a),h,l)}function iu(t,e){if(ou(t=m(t)))return au("Unsupported field value:",e,t),su(t,e);if(t instanceof Xl)return function(t,e){if(!Zl(e.du))throw e.pu(`${t._methodName}() can only be used with update() and set()`);if(!e.path)throw e.pu(`${t._methodName}() is not currently supported inside arrays`);const n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&4!==e.du)throw e.pu("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=iu(i,e.gu(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=m(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return da(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=as.fromDate(t);return{timestampValue:qa(e.serializer,n)}}if(t instanceof as){const n=new as(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:qa(e.serializer,n)}}if(t instanceof Wl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ql)return{bytesValue:Qa(e.serializer,t._byteString)};if(t instanceof jl){const n=e.databaseId,r=t.firestore._databaseId;if(!r.isEqual(n))throw e.pu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ja(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.pu(`Unsupported field value: ${Pl(t)}`)}(t,e)}function su(t,e){const n={};return Ms(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rs(t,((t,r)=>{const i=iu(r,e.Ru(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function ou(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof as||t instanceof Wl||t instanceof ql||t instanceof jl||t instanceof Xl)}function au(t,e,n){if(!ou(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){const r=Pl(n);throw"an object"===r?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function hu(t,e,n){if((e=m(e))instanceof Ql)return e._internalPath;if("string"==typeof e)return function(t,e,n){if(e.search(lu)>=0)throw uu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ql(...e.split("."))._internalPath}catch(r){throw uu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}(t,e);throw uu("Field path arguments must be of type string or ",t,!1,void 0,n)}const lu=new RegExp("[~\\*/\\[\\]]");function uu(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let h="";return(s||o)&&(h+=" (found",s&&(h+=` in field ${r}`),o&&(h+=` in document ${i}`),h+=")"),new qi(Ki.INVALID_ARGUMENT,a+t+h)}function cu(t,e){return t.some((t=>t.isEqual(e)))}function du(t,e){const n=Vl(t.firestore,Gl),r=function(t,e,...n){if(t=m(t),1===arguments.length&&(e=is.newId()),xl("doc","path",e),t instanceof Bl){const r=us.fromString(e,...n);return Rl(r),new jl(t,null,new fs(r))}{if(!(t instanceof jl||t instanceof $l))throw new qi(Ki.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(us.fromString(e,...n));return Rl(r),new jl(t.firestore,t instanceof $l?t.converter:null,new fs(r))}}(t),i=function(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}(t.converter,e);return function(t,e){return function(t,e){const n=new Qi;return t.asyncQueue.enqueueAndForget((async()=>async function(t,e,n){const r=Il(t);try{const t=await function(t,e){const n=zi(t),r=as.now(),i=e.reduce(((t,e)=>t.add(e.key)),ha());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(t=>{let a=Zo(),h=ha();return n.os.getEntries(t,i).next((t=>{a=t,a.forEach(((t,e)=>{e.isValidDocument()||(h=h.add(t))}))})).next((()=>n.localDocuments.getOverlayedDocuments(t,a))).next((i=>{s=i;const o=[];for(const t of e){const e=Oa(t,s.get(t.key).overlayedDocument);null!=e&&o.push(new Ma(t.key,e,po(e.value.mapValue),Aa.exists(!0)))}return n.mutationQueue.addMutationBatch(t,r,o,e)})).next((e=>{o=e;const r=e.applyToLocalDocumentSet(s,h);return n.documentOverlayCache.saveOverlays(t,e.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:na(s)})))}(r.localStore,e);r.sharedClientState.addPendingMutation(t.batchId),function(t,e,n){let r=t.Da[t.currentUser.toKey()];r||(r=new Ps(ss)),r=r.insert(e,n),t.Da[t.currentUser.toKey()]=r}(r,t.batchId,n),await _l(r,t.changes),await nl(r.remoteStore)}catch(t){const e=pl(t,"Failed to persist write");n.reject(e)}}(await kl(t),e,n))),n.promise}(function(t){return t._firestoreClient||Kl(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}(t),e)}(n,[ru(nu(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Aa.exists(!1))]).then((()=>r))}new WeakMap,function(t,e=!0){Pi="10.7.2",tt(new y("firestore",((t,{instanceIdentifier:n,options:r})=>{const i=t.getProvider("app").getImmediate(),s=new Gl(new Yi(t.getProvider("auth-internal")),new ns(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new qi(Ki.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ys(t.options.projectId,e)}(i,n),i);return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),it(Ri,"4.4.1",t),it(Ri,"4.4.1","esm2017")}();var fu=n(379),pu=n.n(fu),gu=n(795),mu=n.n(gu),yu=n(569),vu=n.n(yu),wu=n(565),Eu=n.n(wu),bu=n(216),_u=n.n(bu),Tu=n(589),Iu=n.n(Tu),Cu=n(426),Au={};Au.styleTagTransform=Iu(),Au.setAttributes=Eu(),Au.insert=vu().bind(null,"head"),Au.domAPI=mu(),Au.insertStyleElement=_u(),pu()(Cu.Z,Au),Cu.Z&&Cu.Z.locals&&Cu.Z.locals,n(421);const Su=rt({apiKey:"AIzaSyAd4-LlGsIDg3MrGNiQwGwH9ZuYe-rqpoU",authDomain:"charlyticket-12c27.firebaseapp.com",projectId:"charlyticket-12c27",storageBucket:"charlyticket-12c27.appspot.com",messagingSenderId:"539395668161",appId:"1:539395668161:web:0d9137ea5f3d8e10acbc40",measurementId:"G-942R2Y5F7G"});function Du(){var t=document.getElementById("ticketId").value,e=document.getElementById("firstName").value,n=document.getElementById("phoneNumber").value,r=document.getElementById("gender").value;if(t&&e&&n&&r){var i=t+"-"+e+"-"+n+"-"+r;try{var s=document.getElementById("qrCode");new QRCode(s,{text:i,width:128,height:128})}catch(t){return console.error("Erreur lors de la génération du code QR : ",t),void alert("Une erreur est survenue lors de la génération du code QR. Veuillez réessayer.")}!function(t,e,n,r){du(function(t,e,...n){if(t=m(t),xl("collection","path",e),t instanceof Bl){const r=us.fromString(e,...n);return Ml(r),new $l(t,null,r)}{if(!(t instanceof jl||t instanceof $l))throw new qi(Ki.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(us.fromString(e,...n));return Ml(r),new $l(t.firestore,null,r)}}(zl(Su),"tickets"),{ticketId:t,firstName:e,phoneNumber:n,gender:r}).then((i=>{console.log("Document written with ID: ",i.id),window.location.href="page_tickets.html?id="+t+"&firstName="+e+"&phoneNumber="+n+"&gender="+r})).catch((t=>{console.error("Error adding document: ",t),alert("Une erreur s'est produite lors de l'enregistrement du ticket. Veuillez réessayer plus tard.")}))}(t,e,n,r)}else alert("Veuillez remplir tous les champs du formulaire.")}document.addEventListener("DOMContentLoaded",(()=>{const t=document.getElementById("validateButton");t?t.addEventListener("click",Du):console.error("L'élément 'validateButton' n'existe pas !")})),window.generateTicket=function(){window.location.href="page_formulaire.html"},window.showHistory=function(){window.location.href="page_historique.html"},window.generateQRCode=Du})()})();